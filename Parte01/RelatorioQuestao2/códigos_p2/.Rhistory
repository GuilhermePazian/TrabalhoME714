vp <- vn/n
#vp[vp==0]=0.01
vpc <- cbind(vp)
aux <- vpc%*%t(vpc)
mcov <- matrix(as.numeric((as.matrix(Diagonal(ncat,vpc))- aux)/n),ncat,ncat)
ep <- sqrt(diag(mcov))
epc<-cbind(ep)
}
else if(modelo ==2)# produto de multinomias
{
vn <- as.numeric(apply(tabela,1,sum))
vpg<- tabela/vn#c(t(tabela/vn))
ncatr<- ncol(tabela)
nmult<-nrow(tabela)
#vpg[vpg==0]=0.01
vp <- vpg[1,]
vpc <- cbind(vp)
aux <-vpc%*%t(vpc)
mcov <- matrix((as.matrix(Diagonal(ncatr,vpc))- aux)/vn[1],ncatr,ncatr)
mcovg <-mcov
for(j in 2:nmult)
{
vp <- vpg[j,]
vpc <- cbind(vp)
aux <-vpc%*%t(vpc)
mcov <- matrix((as.matrix(Diagonal(ncatr,vpc))- aux)/vn[j],ncatr,ncatr)
mcovg<-bdiag(mcovg,mcov)
}
mcov<-as.matrix(bdiag(mcovg))
vp<- c(t(vpg))
vpc<-cbind(vp)
ep<- sqrt(diag(mcov))
epc<-cbind(ep)
}
qic <- qnorm(0.5*(1+gama))
LIIC <- c(vpc)-c(qic*epc)
LSIC <- c(vpc)+ c(qic*epc)
mIC  <- cbind(LIIC,LSIC)
mIC[mIC[,1]<=0,1]=0
mIC[mIC[,2]>=1,2]=1
m.result <-cbind(round(vpc,2),round(epc,2),round(mIC,2))
rownames(m.result)<-label
colnames(m.result)<- c("Estimativa","EP","LIIC","LSIC")
cat("Estimativas:","\n")
print(m.result)
result<- list(vpc=vpc,epc=epc,mIC=mIC,mcov=mcov,label=label)
return(result)
}
# gera gr?ficos das porpor??es estimadas (sem considerar modelos)
#input= tabela: tabela de conting?ncia
#       result: objeto com o resultado da aplica??o da fun??o estima.theta
#       oplas: orienta??o dos "labels" do eixo "x"
#       eixo: dimens?o dos labels dos eixos
plot.graf.prop<-function(result,oplas,eixo)
{
label<-c(result$label)
vpc<-cbind(c(result$vpc))
mIC<-(result$mIC)
mIC<- cbind(c(mIC[,1]),c(mIC[,2]))
plotCI(vpc,ui=mIC[,2],li=mIC[,1],axes=F,xlab="categoria",ylab="propor??es",pch=19,cex=1.2,cex.axis=1.2,cex.lab=1.2)
axis(2,cex.axis=1.2)
axis(1,1:length(vpc),labels=label,cex.axis=eixo,las=oplas)
}
# Realiza testes do tipo Bpi=D para uma ?nica tabela
# r x s oriunda de um modelo multinomial
# ou produto de multinomiais
#input= result: objeto com o resultado da aplica??o da fun??o estima.theta
#       m.B e v.D: matriz e vetor definidores das hip?teses de interesse, respectivamente
test.Bpi.D<-function(result,m.B,v.D)
{
vpc<-cbind(c(result$vpc))
mcov<-result$mcov
mcov[mcov==0]<-0.000000000001
e.Q <-t(m.B%*%vpc-v.D)%*%solve(m.B%*%mcov%*%t(m.B))%*%(m.B%*%vpc-v.D)
ngl<-nrow(m.B)
e.pvalor<-1-pchisq(e.Q,ngl)
cat("Estatistica Q = ",round(e.Q,2),"\n")
cat("pvalor = ",round(e.pvalor,4),"\n")
cat("g.l. =",ngl,"\n")
cat("Matriz B :","\n")
print(m.B)
cat("Vetor D :","\n")
print(v.D)
}
# Ajusta modelos de regress?o do tipo Api=Xbeta para uma ?nica tabela
# r x s oriunda de um modelo multinomial
# ou produto de multinomiais
#input= result: objeto com o o resultado da aplica??o da fun??o estima.theta
#       m.B e m.X: matrizes definidoras do modelo de interesse
MR.Api.Xbeta<-function(result,m.A,m.X)
{
label<-c(result$label)
vpc<-cbind(c(result$vpc))
mcov<-result$mcov
mcov[mcov==0]<-0.000000000001
mcovF <- m.A%*%mcov%*%t(m.A)
auxav <- eigen(mcovF,only.values=TRUE)$values
nlmcovF <- nrow(mcovF)
while(min(auxav) <= 0.000000001)
{
mcovF <- mcovF + diag(0.00001,nlmcovF,nlmcovF)
auxav <- eigen(mcovF,only.values=TRUE)$values
}
imcovF <- solve(mcovF)
vF <- m.A%*%vpc
mcovbeta <- solve(t(m.X)%*%imcovF%*%m.X)
vbeta<- mcovbeta%*%t(m.X)%*%imcovF%*%vF
epbeta <- cbind(c(sqrt(diag(mcovbeta))))
epl <- m.X%*%vbeta
eQ <-t(vF-epl)%*%imcovF%*%(vF-epl)
ngl<-nrow(m.X)-nrow(vbeta)
epvalor<-1-pchisq(eQ,ngl)
cat("Est. dos par. beta","\n")
print(round(cbind(vbeta,epbeta),2))
cat("Teste para a qualidade do ajuste do modelo = ",round(eQ,2),"\n")
cat("pvalor = ",round(epvalor,4),"\n")
cat("g.l. =",ngl,"\n")
cat("Matriz A :","\n")
print(m.A)
cat("Matriz X :","\n")
print(m.X)
result<- list(vpc=vpc,vbeta=vbeta,epbeta=epbeta,mcovbeta=mcovbeta,label=label)
return(result)
}
# Testa hip?teses do tipo CB= M para modelos lineares ajustados
# via fun??o MR.Api.Xbeta
# input = result: objeto com o resultado da aplica??o da fun??o MR.Api.Xbeta
# Matrizes m.C e v.M
testa.CB.M.Api.Xbeta<-function(result,m.C,v.M)
{
vbeta <- result$vbeta
mcovbeta <- result$mcovbeta
e.QC <- t(m.C%*%vbeta - v.M)%*%solve(m.C%*%mcovbeta%*%t(m.C))%*%(m.C%*%vbeta - v.M)
ngl<-nrow(m.C)
e.pvalor<-1-pchisq(e.QC,ngl)
cat("Estatistica Q = ",round(e.QC,2),"\n")
cat("pvalor = ",round(e.pvalor,4),"\n")
cat("g.l. =",ngl,"\n")
cat("Matriz C :","\n")
print(m.C)
cat("Vetor M :","\n")
print(v.M)
}
#Estima propor??es sob o modelo Api=Xbeta
#input= result: objeto com o resultado da aplica??o da fun??o MR.Api.Xbeta
#       m.H e v.F: matriz e vetor que recuperam as propor??es originais
estim.prp.ApiXbeta<-function(result,m.H,v.F,gama)
{
label<-result$label
vpc <- result$vpc
vbeta<-result$vbeta
mcovbeta<-result$mcovbeta
vpesm <- m.H%*%vbeta + v.F
mcovsm <- m.H%*%mcovbeta%*%t(m.H)
vepsm <- sqrt(diag(mcovsm))
qic <- qnorm(0.5*(1+gama))
LIIC <- c(vpesm)-c(qic*vepsm)
LSIC <- c(vpesm)+ c(qic*vepsm)
mIC  <- cbind(LIIC,LSIC)
mIC[mIC[,1]<=0,1]=0
mIC[mIC[,2]>=1,2]=1
result<- list(vpesm=vpesm,vepsm=vepsm,mcovbeta=mcovbeta,mIC=mIC)
plot(vpc,axes=F,ylim=c(min(vpc,mIC),max(vpc,mIC)),xlab="categoria",ylab="propor??es",cex=1.2)
plotCI(vpesm,ui=mIC[,2],li=mIC[,1],axes=F,pch=19,cex=1.2,cex.axis=1.2,cex.lab=1.2,add=T)
axis(2,cex.axis=1.2)
axis(1,1:length(vpc),labels=label,cex.axis=1.2)
}
# Ajusta modelos de regress?o do tipo AlnGpi=Xbeta para uma ?nica tabela
# r x s oriunda de um modelo multinomial
# ou produto de multinomiais
# input= result: objeto com o o resultado da aplica??o da fun??o estima.theta
#       m.B, m.G e m.X: matrizes definidoras do modelo de interesse
MR.AlnGpi.Xbeta<-function(result,m.A,m.G,m.X)
{
label<-c(result$label)
vpc<-cbind(c(result$vpc))
mcov<-result$mcov
mcov[mcov==0]<-0.000000000001
auxmG<-m.G%*%vpc
auxmG[auxmG==0]<-0.000000000001
m.B <- solve(diag(c(auxmG)))
mPsi <- m.A%*%m.B%*%m.G
mcovF <- mPsi%*%mcov%*%t(mPsi)
auxav <- eigen(mcovF,only.values=TRUE)$values
nlmcovF <- nrow(mcovF)
while(min(auxav) <= 0.001)
{
mcovF <- mcovF + diag(0.00001,nlmcovF,nlmcovF)
auxav <- eigen(mcovF,only.values=TRUE)$values
}
imcovF <- solve(mcovF)
vF <- m.A%*%(log(auxmG))
mcovbeta <- solve(t(m.X)%*%imcovF%*%m.X)
vbeta<- mcovbeta%*%t(m.X)%*%imcovF%*%vF
epbeta <- cbind(c(sqrt(diag(mcovbeta))))
epl <- m.X%*%vbeta
eQ <-t(vF-epl)%*%imcovF%*%(vF-epl)
ngl<-nrow(m.X)-nrow(vbeta)
epvalor<-1-pchisq(eQ,ngl)
cat("Est. dos par. beta","\n")
print(round(cbind(vbeta,epbeta),2))
cat("Teste para a qualidade do ajuste do modelo = ",round(eQ,2),"\n")
cat("pvalor = ",round(epvalor,4),"\n")
cat("g.l. =",ngl,"\n")
cat("Matriz A :","\n")
print(m.A)
cat("Matriz X :","\n")
print(m.X)
result<- list(vpc=vpc,vbeta=vbeta,epbeta=epbeta,mcovbeta=mcovbeta,label=label)
return(result)
}
teste <- scan("~/Documentos/Discretos/discretos_2017/trabalho/sementes.dat", what = list(integer(), character(), integer(), integer()))
teste[[2]] <- gsub("m\xe9dio", "médio", teste[[2]])
temp.germ <- cbind(factor(as.factor(teste[[1]]), levels = c("11","21"), labels = c("0","1"))) #temperatura de germinação
temp.germ
temp.germ <- cbind(factor(as.factor(teste[[1]]), levels = c("11","21"), labels = c("1","2"))) #temperatura de germinação
nivel.um <- cbind(factor(as.factor(teste[[2]]), levels = c("baixo", "médio", "alto"), labels = c("1", "2", "3")))  #nível de umidade
nivel.temp <- cbind(factor(as.factor(dados$nivel.temp), levels = c("21","42", "62"), labels = c("1","2", "3"))) #nível de temperatura
nivel.temp <- cbind(factor(as.factor(teste[[3]]), levels = c("21","42", "62"), labels = c("1","2", "3"))) #nível de temperatura
sem.germ <- cbind(as.integer(teste[[4]])) #número de sementes germinadas depois de 5 dias
dados <- data.frame(cbind(temp.germ, nivel.um, nivel.temp, sem.germ))
colnames(dados) <- c("temp.germ", "nivel.um", "nivel.temp", "sem.germ")
head(dados)
str(dados)
as.factor(dados$nivel.temp), levels = c("21","42", "62"), labels = c("1","2", "3")
head(dados)
as.factor(dados$temp.germ)
dados$temp.germ <- as.factor(dados$temp.germ)
head(dados)
str(dados)
dados$nivel.um <- as.factor(dados$nivel.um)
str(dados)
dados$nivel.temp <- as.factor(dados$nivel.temp)
dados$sem.germ <- as.numeric(dados$sem.germ)
str(dados)
teste <- scan("~/Documentos/Discretos/discretos_2017/trabalho/sementes.dat", what = list(integer(), character(), integer(), integer()))
teste[[2]] <- gsub("m\xe9dio", "médio", teste[[2]])
temp.germ <- cbind(as.factor(factor(as.factor(teste[[1]]), levels = c("11","21"), labels = c("1","2")))) #temperatura de germinação
nivel.um <- cbind(as.factor(factor(as.factor(teste[[2]]), levels = c("baixo", "médio", "alto"), labels = c("1", "2", "3"))))  #nível de umidade
nivel.temp <- cbind(factor(as.factor(teste[[3]]), levels = c("21","42", "62"), labels = c("1","2", "3"))) #nível de temperatura
sem.germ <- cbind(as.integer(teste[[4]])) #número de sementes germinadas depois de 5 dias
dados <- data.frame(cbind(temp.germ, nivel.um, nivel.temp, sem.germ))
colnames(dados) <- c("temp.germ", "nivel.um", "nivel.temp", "sem.germ")
str(dados)
teste <- scan("~/Documentos/Discretos/discretos_2017/trabalho/sementes.dat", what = list(integer(), character(), integer(), integer()))
teste[[2]] <- gsub("m\xe9dio", "médio", teste[[2]])
temp.germ <- cbind(factor(as.factor(teste[[1]]), levels = c("11","21"), labels = c("1","2"))) #temperatura de germinação
nivel.um <- cbind(factor(as.factor(teste[[2]]), levels = c("baixo", "médio", "alto"), labels = c("1", "2", "3")))  #nível de umidade
nivel.temp <- cbind(factor(as.factor(teste[[3]]), levels = c("21","42", "62"), labels = c("1","2", "3"))) #nível de temperatura
sem.germ <- cbind(as.integer(teste[[4]])) #número de sementes germinadas depois de 5 dias
dados <- data.frame(cbind(temp.germ, nivel.um, nivel.temp, sem.germ))
colnames(dados) <- c("temp.germ", "nivel.um", "nivel.temp", "sem.germ")
dados$temp.germ <- as.factor(dados$temp.germ)
dados$nivel.um <- as.factor(dados$nivel.um)
dados$nivel.temp <- as.factor(dados$nivel.temp)
dados$sem.germ <- as.numeric(dados$sem.germ)
dados
str(dados)
prop.sem.germ <- dados$sem.germ/100
prop.sem.n.germ <- 1 - prop.sem.germ
sd.binom.caselas <- sqrt(prop.sem.germ*prop.sem.n.germ/100)
prop_sd <- cbind(prop.sem.germ, prop.sem.n.germ, sd.binom.caselas)
colnames(prop_sd) <- c("proporção de sementes germinadas", "proporção de sementes não germinadas", "sd")
dados <- cbind(dados, prop_sd)
head(dados)
str(dados)
par(mfrow=c(1,2))
plot(dados$`proporção de sementes germinadas`[1:3],axes=FALSE,ylim=c(0.0,1.0),cex.lab=1.5,xlab="Nível de temperatura",ylab="Proporção de sementes germinadas")
axis(2,cex.axis=1.2)
axis(1,1:3,c("21ºC","42ºC", "62ºC"),cex.axis=1.2)
plotCI(dados$`proporção de sementes germinadas`[1:3],liw=1.96*dados$`proporção de sementes germinadas`[1:3]*dados$sd[1:3],uiw=1.96*dados$`proporção de sementes germinadas`[1:3]*dados$sd[1:3],pch=19,add=TRUE,cex.lab=1.5,slty=1,lwd=2,col=4,cex=1.2)
lines(dados$`proporção de sementes germinadas`[1:3],lwd=2,col=4)
plotCI(dados$`proporção de sementes germinadas`[4:6],liw=1.96*dados$`proporção de sementes germinadas`[4:6]*dados$sd[4:6],uiw=1.96*dados$`proporção de sementes germinadas`[4:6]*dados$sd[4:6],pch=19,add=TRUE,cex.lab=1.5,slty=1,lwd=2,col=2,cex=1.2)
lines(dados$`proporção de sementes germinadas`[4:6],lwd=2,col=2)
plotCI(dados$`proporção de sementes germinadas`[7:9],liw=1.96*dados$`proporção de sementes germinadas`[7:9]*dados$sd[7:9],uiw=1.96*dados$`proporção de sementes germinadas`[7:9]*dados$sd[7:9],pch=19,add=TRUE,cex.lab=1.5,slty=1,lwd=2,col=1,cex=1.2)
lines(dados$`proporção de sementes germinadas`[7:9],lwd=2,col=1)
legend(1,0.15,col=c(4,2,1),lwd=c(2,2),pch=c(19,23),pt.bg=c(2,2),legend=c("Umidade baixa para germinação em 11ºC","Umidade média para germinação em 11ºC", "Umidade alta para germinação em 11ºC"),bty="n",cex=1)
plot(dados$`proporção de sementes germinadas`[10:12],axes=FALSE,ylim=c(0.0,1.0),cex.lab=1.5,xlab="Nível de temperatura",ylab="Proporção de sementes germinadas")
axis(2,cex.axis=1.2)
axis(1,1:3,c("21ºC","42ºC", "62ºC"),cex.axis=1.2)
plotCI(dados$`proporção de sementes germinadas`[10:12],liw=1.96*dados$`proporção de sementes germinadas`[10:12]*dados$sd[10:12],uiw=1.96*dados$`proporção de sementes germinadas`[10:12]*dados$sd[10:12],pch=19,add=TRUE,cex.lab=1.5,slty=1,lwd=2,col=4,cex=1.2)
lines(dados$`proporção de sementes germinadas`[10:12],lwd=2,col=4)
plotCI(dados$`proporção de sementes germinadas`[13:15],liw=1.96*dados$`proporção de sementes germinadas`[13:15]*dados$sd[13:15],uiw=1.96*dados$`proporção de sementes germinadas`[13:15]*dados$sd[13:15],pch=19,add=TRUE,cex.lab=1.5,slty=1,lwd=2,col=2,cex=1.2)
lines(dados$`proporção de sementes germinadas`[13:15],lwd=2,col=2)
plotCI(dados$`proporção de sementes germinadas`[16:18],liw=1.96*dados$`proporção de sementes germinadas`[16:18]*dados$sd[16:18],uiw=1.96*dados$`proporção de sementes germinadas`[16:18]*dados$sd[16:18],pch=19,add=TRUE,cex.lab=1.5,slty=1,lwd=2,col=1,cex=1.2)
lines(dados$`proporção de sementes germinadas`[16:18],lwd=2,col=1)
legend(1,0.15,col=c(4,2,1),lwd=c(2,2),pch=c(19,23),pt.bg=c(2,2),legend=c("Umidade baixa para germinação em 21ºC","Umidade média para germinação em 21ºC", "Umidade alta para germinação em 21ºC"),bty="n",cex=1)
ajuda <- dados %>% group_by(temp.germ,nivel.um) %>% summarise(DP=sd(sem.germ), medias = mean(sem.germ))
ajuda <- data.frame(ajuda)
cvs <- 100*ajuda$DP/ajuda$medias
med.resumo <- dados %>% group_by(temp.germ,nivel.um) %>% summarise(media = mean(sem.germ), vari = var(sem.germ), DP = sd(sem.germ), MAX = max(sem.germ), MIN = min(sem.germ))
med.resumo <- data.frame(med.resumo)
med.resumo <- cbind(med.resumo, cvs)
med.resumo
dados %>% group_by(temp.germ,nivel.um) %>% summarise(DP=sd(sem.germ), medias = mean(sem.germ))
dados %>% group_by(temp.germ,nivel.um)
dados %>% group_by(temp.germ,nivel.um)
dados %>% group_by(temp.germ,nivel.um) %>% summarise(DP=sd(sem.germ), medias = mean(sem.germ))
dados %>% group_by(temp.germ,nivel.um) %>% summarise(medias = mean(sem.germ))
library(dplyr)
library(ggplot2)
library(xtable)
library(plotrix)
library(plyr)
teste <- scan("~/Documentos/Discretos/discretos_2017/trabalho/sementes.dat", what = list(integer(), character(), integer(), integer()))
teste[[2]] <- gsub("m\xe9dio", "médio", teste[[2]])
temp.germ <- cbind(factor(as.factor(teste[[1]]), levels = c("11","21"), labels = c("1","2"))) #temperatura de germinação
nivel.um <- cbind(factor(as.factor(teste[[2]]), levels = c("baixo", "médio", "alto"), labels = c("1", "2", "3")))  #nível de umidade
nivel.temp <- cbind(factor(as.factor(teste[[3]]), levels = c("21","42", "62"), labels = c("1","2", "3"))) #nível de temperatura
sem.germ <- cbind(as.integer(teste[[4]])) #número de sementes germinadas depois de 5 dias
dados <- data.frame(cbind(temp.germ, nivel.um, nivel.temp, sem.germ))
colnames(dados) <- c("temp.germ", "nivel.um", "nivel.temp", "sem.germ")
dados$temp.germ <- as.factor(dados$temp.germ)
dados$nivel.um <- as.factor(dados$nivel.um)
dados$nivel.temp <- as.factor(dados$nivel.temp)
dados$sem.germ <- as.numeric(dados$sem.germ)
dados
prop.sem.germ <- dados$sem.germ/100
prop.sem.n.germ <- 1 - prop.sem.germ
sd.binom.caselas <- sqrt(prop.sem.germ*prop.sem.n.germ/100)
prop_sd <- cbind(prop.sem.germ, prop.sem.n.germ, sd.binom.caselas)
colnames(prop_sd) <- c("proporção de sementes germinadas", "proporção de sementes não germinadas", "sd")
dados <- cbind(dados, prop_sd)
dados
par(mfrow=c(1,2))
plot(dados$`proporção de sementes germinadas`[1:3],axes=FALSE,ylim=c(0.0,1.0),cex.lab=1.5,xlab="Nível de temperatura",ylab="Proporção de sementes germinadas")
axis(2,cex.axis=1.2)
axis(1,1:3,c("21ºC","42ºC", "62ºC"),cex.axis=1.2)
plotCI(dados$`proporção de sementes germinadas`[1:3],liw=1.96*dados$`proporção de sementes germinadas`[1:3]*dados$sd[1:3],uiw=1.96*dados$`proporção de sementes germinadas`[1:3]*dados$sd[1:3],pch=19,add=TRUE,cex.lab=1.5,slty=1,lwd=2,col=4,cex=1.2)
lines(dados$`proporção de sementes germinadas`[1:3],lwd=2,col=4)
plotCI(dados$`proporção de sementes germinadas`[4:6],liw=1.96*dados$`proporção de sementes germinadas`[4:6]*dados$sd[4:6],uiw=1.96*dados$`proporção de sementes germinadas`[4:6]*dados$sd[4:6],pch=19,add=TRUE,cex.lab=1.5,slty=1,lwd=2,col=2,cex=1.2)
lines(dados$`proporção de sementes germinadas`[4:6],lwd=2,col=2)
plotCI(dados$`proporção de sementes germinadas`[7:9],liw=1.96*dados$`proporção de sementes germinadas`[7:9]*dados$sd[7:9],uiw=1.96*dados$`proporção de sementes germinadas`[7:9]*dados$sd[7:9],pch=19,add=TRUE,cex.lab=1.5,slty=1,lwd=2,col=1,cex=1.2)
lines(dados$`proporção de sementes germinadas`[7:9],lwd=2,col=1)
legend(1,0.15,col=c(4,2,1),lwd=c(2,2),pch=c(19,23),pt.bg=c(2,2),legend=c("Umidade baixa para germinação em 11ºC","Umidade média para germinação em 11ºC", "Umidade alta para germinação em 11ºC"),bty="n",cex=1)
plot(dados$`proporção de sementes germinadas`[10:12],axes=FALSE,ylim=c(0.0,1.0),cex.lab=1.5,xlab="Nível de temperatura",ylab="Proporção de sementes germinadas")
axis(2,cex.axis=1.2)
axis(1,1:3,c("21ºC","42ºC", "62ºC"),cex.axis=1.2)
plotCI(dados$`proporção de sementes germinadas`[10:12],liw=1.96*dados$`proporção de sementes germinadas`[10:12]*dados$sd[10:12],uiw=1.96*dados$`proporção de sementes germinadas`[10:12]*dados$sd[10:12],pch=19,add=TRUE,cex.lab=1.5,slty=1,lwd=2,col=4,cex=1.2)
lines(dados$`proporção de sementes germinadas`[10:12],lwd=2,col=4)
plotCI(dados$`proporção de sementes germinadas`[13:15],liw=1.96*dados$`proporção de sementes germinadas`[13:15]*dados$sd[13:15],uiw=1.96*dados$`proporção de sementes germinadas`[13:15]*dados$sd[13:15],pch=19,add=TRUE,cex.lab=1.5,slty=1,lwd=2,col=2,cex=1.2)
lines(dados$`proporção de sementes germinadas`[13:15],lwd=2,col=2)
plotCI(dados$`proporção de sementes germinadas`[16:18],liw=1.96*dados$`proporção de sementes germinadas`[16:18]*dados$sd[16:18],uiw=1.96*dados$`proporção de sementes germinadas`[16:18]*dados$sd[16:18],pch=19,add=TRUE,cex.lab=1.5,slty=1,lwd=2,col=1,cex=1.2)
lines(dados$`proporção de sementes germinadas`[16:18],lwd=2,col=1)
legend(1,0.15,col=c(4,2,1),lwd=c(2,2),pch=c(19,23),pt.bg=c(2,2),legend=c("Umidade baixa para germinação em 21ºC","Umidade média para germinação em 21ºC", "Umidade alta para germinação em 21ºC"),bty="n",cex=1)
dados %>% group_by(temp.germ,nivel.um) %>% summarise(DP=sd(sem.germ), medias = mean(sem.germ))
str(dados)
dados %>% group_by(temp.germ,nivel.um) %>% summarise(medias = mean(sem.germ))
dados %>% group_by(temp.germ,nivel.um)
head(dados)
dados %>% filter(temp.germ, nivel.um, nivel.temp, sem.germ)
dados %>% select(temp.germ, nivel.um, nivel.temp, sem.germ)
dados %>% select(temp.germ, nivel.um, nivel.temp, sem.germ) %>% group_by(temp.germ, nivel.um)
dados %>% select(temp.germ, nivel.um, nivel.temp, sem.germ) %>% group_by(temp.germ, nivel.um) %>% summarise(medias = mean(sem.germ))
dados %>% select(temp.germ, nivel.um, nivel.temp, sem.germ) %>% group_by( nivel.um) %>% summarise(medias = mean(sem.germ))
dados %>% select(temp.germ, nivel.um, nivel.temp, sem.germ) %>% group_by(nivel.um, nivel.temp) %>% summarise(medias = mean(sem.germ))
str(dados)
glm(dados$sem.germ ~ dados$temp.germ + dados$nivel.um + dados$nivel.temp + dados$nivel.um*dados$nivel.temp,family=binomial(link="logit"))
glm(dados$`proporção de sementes germinadas` ~ dados$temp.germ + dados$nivel.um + dados$nivel.temp + dados$nivel.um*dados$nivel.temp,family=binomial(link="logit"))
m.dados <- scan("~/Documentos/Discretos/discretos_2017/codigos/Modelos_de_regressao_para_dados_discretos/prefauto.dat",what=list(0,0,0,0))
v.pref<- cbind(m.dados[[1]]) # prefer?ncia
v.ida<-cbind(m.dados[[2]]) # idade
v.gen<-cbind(m.dados[[3]])  # g?nero
v.eciv <- cbind(m.dados[[4]]) # estado civil
n <- length(v.pref)
cbind(v.pref,v.ida,v.gen,v.eciv)
genfac<- factor(as.factor(v.gen),levels=c("0","1"),labels=c("masculino","feminino"))#C(as.factor(tmater))
ecivfac<- factor(as.factor(v.eciv),levels=c("0","1"),labels=c("casado","solteiro"))#C(as.factor(tmater))
preffac <- factor(as.factor(v.pref),levels=c("0","1"),labels=c("japon?s","americano"))
data.frame(preffac,v.ida,genfac,ecivfac)
dados %>% select(temp.germ, nivel.um, nivel.temp, sem.germ)
dados %>% select(temp.germ, nivel.um, nivel.temp, sem.germ) %>% group_by(temp.germ, nivel.um) %>% summarise(medias = mean(sem.germ))
dados %>% select(temp.germ, nivel.um, nivel.temp, sem.germ) %>% group_by(temp.germ, nivel.um)
teste <- scan("~/Documentos/Discretos/discretos_2017/trabalho/sementes.dat", what = list(integer(), character(), integer(), integer()))
teste[[2]] <- gsub("m\xe9dio", "médio", teste[[2]])
temp.germ <- cbind(factor(as.factor(teste[[1]]), levels = c("11","21"), labels = c("1","2"))) #temperatura de germinação
nivel.um <- cbind(factor(as.factor(teste[[2]]), levels = c("baixo", "médio", "alto"), labels = c("1", "2", "3")))  #nível de umidade
#1 = baixo, 2 = médio e 3 = alto
nivel.temp <- cbind(factor(as.factor(teste[[3]]), levels = c("21","42", "62"), labels = c("1","2", "3"))) #nível de temperatura
sem.germ <- cbind(as.integer(teste[[4]])) #número de sementes germinadas depois de 5 dias
dados <- data.frame(cbind(temp.germ, nivel.um, nivel.temp, sem.germ))
colnames(dados) <- c("temp.germ", "nivel.um", "nivel.temp", "sem.germ")
str
str(dados)
prop.sem.germ <- dados$sem.germ/100
prop.sem.n.germ <- 1 - prop.sem.germ
sd.binom.caselas <- sqrt(prop.sem.germ*prop.sem.n.germ/100)
prop_sd <- cbind(prop.sem.germ, prop.sem.n.germ, sd.binom.caselas)
colnames(prop_sd) <- c("proporção de sementes germinadas", "proporção de sementes não germinadas", "sd")
dados <- cbind(dados, prop_sd)
dados
par(mfrow=c(1,2))
plot(dados$`proporção de sementes germinadas`[1:3],axes=FALSE,ylim=c(0.0,1.0),cex.lab=1.5,xlab="Nível de temperatura",ylab="Proporção de sementes germinadas")
axis(2,cex.axis=1.2)
axis(1,1:3,c("21ºC","42ºC", "62ºC"),cex.axis=1.2)
plotCI(dados$`proporção de sementes germinadas`[1:3],liw=1.96*dados$`proporção de sementes germinadas`[1:3]*dados$sd[1:3],uiw=1.96*dados$`proporção de sementes germinadas`[1:3]*dados$sd[1:3],pch=19,add=TRUE,cex.lab=1.5,slty=1,lwd=2,col=4,cex=1.2)
lines(dados$`proporção de sementes germinadas`[1:3],lwd=2,col=4)
plotCI(dados$`proporção de sementes germinadas`[4:6],liw=1.96*dados$`proporção de sementes germinadas`[4:6]*dados$sd[4:6],uiw=1.96*dados$`proporção de sementes germinadas`[4:6]*dados$sd[4:6],pch=19,add=TRUE,cex.lab=1.5,slty=1,lwd=2,col=2,cex=1.2)
lines(dados$`proporção de sementes germinadas`[4:6],lwd=2,col=2)
plotCI(dados$`proporção de sementes germinadas`[7:9],liw=1.96*dados$`proporção de sementes germinadas`[7:9]*dados$sd[7:9],uiw=1.96*dados$`proporção de sementes germinadas`[7:9]*dados$sd[7:9],pch=19,add=TRUE,cex.lab=1.5,slty=1,lwd=2,col=1,cex=1.2)
lines(dados$`proporção de sementes germinadas`[7:9],lwd=2,col=1)
legend(1,0.15,col=c(4,2,1),lwd=c(2,2),pch=c(19,23),pt.bg=c(2,2),legend=c("Umidade baixa para germinação em 11ºC","Umidade média para germinação em 11ºC", "Umidade alta para germinação em 11ºC"),bty="n",cex=1)
plot(dados$`proporção de sementes germinadas`[10:12],axes=FALSE,ylim=c(0.0,1.0),cex.lab=1.5,xlab="Nível de temperatura",ylab="Proporção de sementes germinadas")
axis(2,cex.axis=1.2)
axis(1,1:3,c("21ºC","42ºC", "62ºC"),cex.axis=1.2)
plotCI(dados$`proporção de sementes germinadas`[10:12],liw=1.96*dados$`proporção de sementes germinadas`[10:12]*dados$sd[10:12],uiw=1.96*dados$`proporção de sementes germinadas`[10:12]*dados$sd[10:12],pch=19,add=TRUE,cex.lab=1.5,slty=1,lwd=2,col=4,cex=1.2)
lines(dados$`proporção de sementes germinadas`[10:12],lwd=2,col=4)
plotCI(dados$`proporção de sementes germinadas`[13:15],liw=1.96*dados$`proporção de sementes germinadas`[13:15]*dados$sd[13:15],uiw=1.96*dados$`proporção de sementes germinadas`[13:15]*dados$sd[13:15],pch=19,add=TRUE,cex.lab=1.5,slty=1,lwd=2,col=2,cex=1.2)
lines(dados$`proporção de sementes germinadas`[13:15],lwd=2,col=2)
plotCI(dados$`proporção de sementes germinadas`[16:18],liw=1.96*dados$`proporção de sementes germinadas`[16:18]*dados$sd[16:18],uiw=1.96*dados$`proporção de sementes germinadas`[16:18]*dados$sd[16:18],pch=19,add=TRUE,cex.lab=1.5,slty=1,lwd=2,col=1,cex=1.2)
lines(dados$`proporção de sementes germinadas`[16:18],lwd=2,col=1)
legend(1,0.15,col=c(4,2,1),lwd=c(2,2),pch=c(19,23),pt.bg=c(2,2),legend=c("Umidade baixa para germinação em 21ºC","Umidade média para germinação em 21ºC", "Umidade alta para germinação em 21ºC"),bty="n",cex=1)
dados %>% group_by(temp.germ, nivel.um)
dados %>% group_by(temp.germ, nivel.um) %>% summarise(medias = mean(sem.germ))
v.pref
teste <- scan("~/Documentos/Discretos/discretos_2017/trabalho/sementes.dat", what = list(integer(), character(), integer(), integer()))
teste[[2]] <- gsub("m\xe9dio", "médio", teste[[2]])
temp.germ <- cbind(factor(as.factor(teste[[1]]), levels = c("11","21"), labels = c("1","2"))) #temperatura de germinação
nivel.um <- cbind(factor(as.factor(teste[[2]]), levels = c("baixo", "médio", "alto"), labels = c("1", "2", "3")))  #nível de umidade
#1 = baixo, 2 = médio e 3 = alto
nivel.temp <- cbind(factor(as.factor(teste[[3]]), levels = c("21","42", "62"), labels = c("1","2", "3"))) #nível de temperatura
sem.germ <- cbind(as.integer(teste[[4]])) #número de sementes germinadas depois de 5 dias
dados <- data.frame(cbind(temp.germ, nivel.um, nivel.temp, sem.germ))
colnames(dados) <- c("temp.germ", "nivel.um", "nivel.temp", "sem.germ")
dados$temp.germ <- as.factor(dados$temp.germ)
dados$nivel.um <- as.factor(dados$nivel.um)
dados$nivel.temp <- as.factor(dados$nivel.temp)
dados$sem.germ <- as.numeric(dados$sem.germ)
prop.sem.germ <- dados$sem.germ/100
prop.sem.n.germ <- 1 - prop.sem.germ
sd.binom.caselas <- sqrt(prop.sem.germ*prop.sem.n.germ/100)
prop_sd <- cbind(prop.sem.germ, prop.sem.n.germ, sd.binom.caselas)
colnames(prop_sd) <- c("proporção de sementes germinadas", "proporção de sementes não germinadas", "sd")
dados <- cbind(dados, prop_sd)
par(mfrow=c(1,2))
plot(dados$`proporção de sementes germinadas`[1:3],axes=FALSE,ylim=c(0.0,1.0),cex.lab=1.5,xlab="Nível de temperatura",ylab="Proporção de sementes germinadas")
axis(2,cex.axis=1.2)
axis(1,1:3,c("21ºC","42ºC", "62ºC"),cex.axis=1.2)
plotCI(dados$`proporção de sementes germinadas`[1:3],liw=1.96*dados$`proporção de sementes germinadas`[1:3]*dados$sd[1:3],uiw=1.96*dados$`proporção de sementes germinadas`[1:3]*dados$sd[1:3],pch=19,add=TRUE,cex.lab=1.5,slty=1,lwd=2,col=4,cex=1.2)
lines(dados$`proporção de sementes germinadas`[1:3],lwd=2,col=4)
plotCI(dados$`proporção de sementes germinadas`[4:6],liw=1.96*dados$`proporção de sementes germinadas`[4:6]*dados$sd[4:6],uiw=1.96*dados$`proporção de sementes germinadas`[4:6]*dados$sd[4:6],pch=19,add=TRUE,cex.lab=1.5,slty=1,lwd=2,col=2,cex=1.2)
lines(dados$`proporção de sementes germinadas`[4:6],lwd=2,col=2)
plotCI(dados$`proporção de sementes germinadas`[7:9],liw=1.96*dados$`proporção de sementes germinadas`[7:9]*dados$sd[7:9],uiw=1.96*dados$`proporção de sementes germinadas`[7:9]*dados$sd[7:9],pch=19,add=TRUE,cex.lab=1.5,slty=1,lwd=2,col=1,cex=1.2)
lines(dados$`proporção de sementes germinadas`[7:9],lwd=2,col=1)
legend(1,0.15,col=c(4,2,1),lwd=c(2,2),pch=c(19,23),pt.bg=c(2,2),legend=c("Umidade baixa para germinação em 11ºC","Umidade média para germinação em 11ºC", "Umidade alta para germinação em 11ºC"),bty="n",cex=1)
plot(dados$`proporção de sementes germinadas`[10:12],axes=FALSE,ylim=c(0.0,1.0),cex.lab=1.5,xlab="Nível de temperatura",ylab="Proporção de sementes germinadas")
axis(2,cex.axis=1.2)
axis(1,1:3,c("21ºC","42ºC", "62ºC"),cex.axis=1.2)
plotCI(dados$`proporção de sementes germinadas`[10:12],liw=1.96*dados$`proporção de sementes germinadas`[10:12]*dados$sd[10:12],uiw=1.96*dados$`proporção de sementes germinadas`[10:12]*dados$sd[10:12],pch=19,add=TRUE,cex.lab=1.5,slty=1,lwd=2,col=4,cex=1.2)
lines(dados$`proporção de sementes germinadas`[10:12],lwd=2,col=4)
plotCI(dados$`proporção de sementes germinadas`[13:15],liw=1.96*dados$`proporção de sementes germinadas`[13:15]*dados$sd[13:15],uiw=1.96*dados$`proporção de sementes germinadas`[13:15]*dados$sd[13:15],pch=19,add=TRUE,cex.lab=1.5,slty=1,lwd=2,col=2,cex=1.2)
lines(dados$`proporção de sementes germinadas`[13:15],lwd=2,col=2)
plotCI(dados$`proporção de sementes germinadas`[16:18],liw=1.96*dados$`proporção de sementes germinadas`[16:18]*dados$sd[16:18],uiw=1.96*dados$`proporção de sementes germinadas`[16:18]*dados$sd[16:18],pch=19,add=TRUE,cex.lab=1.5,slty=1,lwd=2,col=1,cex=1.2)
lines(dados$`proporção de sementes germinadas`[16:18],lwd=2,col=1)
legend(1,0.15,col=c(4,2,1),lwd=c(2,2),pch=c(19,23),pt.bg=c(2,2),legend=c("Umidade baixa para germinação em 21ºC","Umidade média para germinação em 21ºC", "Umidade alta para germinação em 21ºC"),bty="n",cex=1)
dados %>% group_by(temp.germ, nivel.um) %>% summarise(medias = mean(sem.germ))
dados %>% group_by(temp.germ, nivel.um)
dados %>% group_by(temp.germ,nivel.um) %>% summarise(media = mean(sem.germ), vari = var(sem.germ), DP = sd(sem.germ), MAX = max(sem.germ), MIN = min(sem.germ))
dados %>% group_by(nivel.um. temp.germ)
dados %>% group_by(nivel.um, temp.germ)
dados %>% group_by(nivel.um, temp.germ) %>% summarise(medias = mean(sem.germ))
dados %>% group_by(nivel.um, nivel.temp)
dados %>% group_by(temp.germ, nivel.um)
dados %>% group_by(temp.germ, nivel.um)
is.data.frame(dados)
dados %>% group_by(temp.germ, nivel.um) %>% summarise(medias = mean(sem.germ))
mean(dados$sem.germ)
dados %>% group_by(temp.germ, nivel.um, nivel.temp)
dados %>% group_by(temp.germ, nivel.temp)
dados %>% filter(temp.germ==1)
dados %>% filter(temp.germ==1) %>% group_by(nivel.um, nivel.temp) %>% summarise(medias = mean(sem.germ))
dados %>% filter(temp.germ==1) %>% group_by(temp.germ,nivel.um) %>% summarise(medias = mean(sem.germ))
teste <- scan("~/Documentos/Discretos/discretos_2017/trabalho/sementes.dat", what = list(integer(), character(), integer(), integer()))
teste[[2]] <- gsub("m\xe9dio", "médio", teste[[2]])
temp.germ <- cbind(as.integer(teste[[1]]))
nivel.um <- cbind(factor(as.factor(teste[[2]]), levels = c("baixo", "médio", "alto"), labels = c("1", "2", "3")))  #nível de umidade
nivel.temp <- cbind(as.integer(teste[[3]]))
sem.germ <- cbind(as.integer(teste[[4]])) #número de sementes germinadas depois de 5 dias
dados <- data.frame(cbind(temp.germ, nivel.um, nivel.temp, sem.germ))
colnames(dados) <- c("temp.germ", "nivel.um", "nivel.temp", "sem.germ")
head(dados)
str(dados)
prop.sem.germ <- dados$sem.germ/100
prop.sem.n.germ <- 1 - prop.sem.germ
sd.binom.caselas <- sqrt(prop.sem.germ*prop.sem.n.germ/100)
prop_sd <- cbind(prop.sem.germ, prop.sem.n.germ, sd.binom.caselas)
colnames(prop_sd) <- c("proporção de sementes germinadas", "proporção de sementes não germinadas", "sd")
dados <- cbind(dados, prop_sd)
par(mfrow=c(1,2))
plot(dados$`proporção de sementes germinadas`[1:3],axes=FALSE,ylim=c(0.0,1.0),cex.lab=1.5,xlab="Nível de temperatura",ylab="Proporção de sementes germinadas")
axis(2,cex.axis=1.2)
axis(1,1:3,c("21ºC","42ºC", "62ºC"),cex.axis=1.2)
plotCI(dados$`proporção de sementes germinadas`[1:3],liw=1.96*dados$`proporção de sementes germinadas`[1:3]*dados$sd[1:3],uiw=1.96*dados$`proporção de sementes germinadas`[1:3]*dados$sd[1:3],pch=19,add=TRUE,cex.lab=1.5,slty=1,lwd=2,col=4,cex=1.2)
lines(dados$`proporção de sementes germinadas`[1:3],lwd=2,col=4)
plotCI(dados$`proporção de sementes germinadas`[4:6],liw=1.96*dados$`proporção de sementes germinadas`[4:6]*dados$sd[4:6],uiw=1.96*dados$`proporção de sementes germinadas`[4:6]*dados$sd[4:6],pch=19,add=TRUE,cex.lab=1.5,slty=1,lwd=2,col=2,cex=1.2)
lines(dados$`proporção de sementes germinadas`[4:6],lwd=2,col=2)
plotCI(dados$`proporção de sementes germinadas`[7:9],liw=1.96*dados$`proporção de sementes germinadas`[7:9]*dados$sd[7:9],uiw=1.96*dados$`proporção de sementes germinadas`[7:9]*dados$sd[7:9],pch=19,add=TRUE,cex.lab=1.5,slty=1,lwd=2,col=1,cex=1.2)
lines(dados$`proporção de sementes germinadas`[7:9],lwd=2,col=1)
legend(1,0.15,col=c(4,2,1),lwd=c(2,2),pch=c(19,23),pt.bg=c(2,2),legend=c("Umidade baixa para germinação em 11ºC","Umidade média para germinação em 11ºC", "Umidade alta para germinação em 11ºC"),bty="n",cex=1)
plot(dados$`proporção de sementes germinadas`[10:12],axes=FALSE,ylim=c(0.0,1.0),cex.lab=1.5,xlab="Nível de temperatura",ylab="Proporção de sementes germinadas")
axis(2,cex.axis=1.2)
axis(1,1:3,c("21ºC","42ºC", "62ºC"),cex.axis=1.2)
plotCI(dados$`proporção de sementes germinadas`[10:12],liw=1.96*dados$`proporção de sementes germinadas`[10:12]*dados$sd[10:12],uiw=1.96*dados$`proporção de sementes germinadas`[10:12]*dados$sd[10:12],pch=19,add=TRUE,cex.lab=1.5,slty=1,lwd=2,col=4,cex=1.2)
lines(dados$`proporção de sementes germinadas`[10:12],lwd=2,col=4)
plotCI(dados$`proporção de sementes germinadas`[13:15],liw=1.96*dados$`proporção de sementes germinadas`[13:15]*dados$sd[13:15],uiw=1.96*dados$`proporção de sementes germinadas`[13:15]*dados$sd[13:15],pch=19,add=TRUE,cex.lab=1.5,slty=1,lwd=2,col=2,cex=1.2)
lines(dados$`proporção de sementes germinadas`[13:15],lwd=2,col=2)
plotCI(dados$`proporção de sementes germinadas`[16:18],liw=1.96*dados$`proporção de sementes germinadas`[16:18]*dados$sd[16:18],uiw=1.96*dados$`proporção de sementes germinadas`[16:18]*dados$sd[16:18],pch=19,add=TRUE,cex.lab=1.5,slty=1,lwd=2,col=1,cex=1.2)
lines(dados$`proporção de sementes germinadas`[16:18],lwd=2,col=1)
legend(1,0.15,col=c(4,2,1),lwd=c(2,2),pch=c(19,23),pt.bg=c(2,2),legend=c("Umidade baixa para germinação em 21ºC","Umidade média para germinação em 21ºC", "Umidade alta para germinação em 21ºC"),bty="n",cex=1)
dados %>% filter(temp.germ==1) %>% group_by(temp.germ,nivel.um)
dados
dados %>% filter(temp.germ==11) %>% group_by(temp.germ,nivel.um) %>% summarise(medias=mean(sem.germ))
