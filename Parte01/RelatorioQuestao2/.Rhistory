source("códigos_p2/model_results.R")
sem <- read.table("códigos_p2/sementes.dat")
source("códigos_p2/model_results.R")
source("códigos_p2/model_results.R")
sem <- read.table("códigos_p2/sementes.dat")
names(sem) = c("Temperatura","Nivel_Umidade","Temp_Umidade","N_de_sementes")
sem$Nivel_Umidade <- gsub("m\xe9dio","medio",sem$Nivel_Umidade)
for(i in 1:3) sem[,i] <- as.factor(sem[,i])
sapply(sem,class)
prop.germ <- sem$N_de_sementes/100
sem <- cbind(sem, prop.germ)
m=rep(100,18)
--------------------
# MODELO COM INTERACAO TRIPLA
sem_binfit_mod1 <- glm(cbind(sem$N_de_sementes,100-sem$N_de_sementes)~ Nivel_Umidade*Temp_Umidade + Temperatura*Nivel_Umidade + Temperatura*Temp_Umidade + Temperatura*Temp_Umidade*Nivel_Umidade,sem,family = binomial())
source("códigos_p2/model_results.R")
source("códigos_p2/model_results.R")
source("códigos_p2/model_results.R")
source("códigos_p2/model_results.R")
ls()
sem_binfit_mod1 <- glm(cbind(sem$N_de_sementes,100-sem$N_de_sementes)~ Nivel_Umidade*Temp_Umidade + Temperatura*Nivel_Umidade + Temperatura*Temp_Umidade + Temperatura*Temp_Umidade*Nivel_Umidade,sem,family = binomial())
summary(sem_binfit_mod1)
ls()
desvs
desvs_pvals
desvs_pvals[,1]
source("códigos_p2/model_results.R")
coef(sem_binfit_mod3)
coef(sem_binfit_mod3)[1]
coef(sem_binfit_mod3)[[1]]
exp(coef(sem_binfit_mod3)[[1]])
exp(coef(sem_binfit_mod3)[[3]])
exp(coef(sem_binfit_mod3)[[5]])
sem_binfit_mod3)[[5]]
sem_binfit_mod3[[5]]
exp(coef(sem_binfit_mod3)[[6]])
exp(coef(sem_binfit_mod3)[[5]])
exp(coef(sem_binfit_mod3)[[6]])
exp(coef(sem_binfit_mod3)[[4]])
exp(coef(sem_binfit_mod3)[[3]])
exp(coef(sem_binfit_mod3)[[2]])
exp(coef(sem_binfit_mod3)[[5]])
round(exp(coef(sem_binfit_mod3)[[5]]),4)
plot(dados$`proporção de sementes germinadas`[1:3],axes=FALSE,ylim=c(0.0,1.0),cex.lab=.8,xlab="Nível de temperatura",ylab="Proporção de sementes germinadas", main = "Temperatura de germinação à 11ºC")
#mudando o separador decimal para resultados "printados"
options(OutDec= ",")
#definindo opções padrões dos chunks
knitr::opts_chunk$set(fig.width=6, fig.height=3.5, fig.path='Figs/', fig.align='center', echo=FALSE, warning=FALSE, message=FALSE)
#bibliotecas que possivelmente serão utilizadas
library(dplyr)
library(ggplot2)
library(xtable)
library(plotrix)
library(plyr)
#df_2 = read.table("http://www.ime.unicamp.br/~cnaber/sementes.dat")
#names(df_2) = c("Temperatura","Nivel_Umidade","Temp_Umidade","N_de_sementes")
teste <- read.table("códigos_p2/sementes.dat")
teste$V2 <- gsub("m\xe9dio", "médio", teste$V2)
#temp.germ <- cbind(teste[[1]])
#temp.germ <- cbind(factor(as.factor(teste[[1]]), levels = c("11","21"), labels = c("1","2"))) #temperatura de germinação
#temp.germ <- cbind(as.integer(teste[[1]]))
#nivel.um <- cbind(teste[[2]])
#nivel.um <- cbind(factor(as.factor(teste[[2]]), levels = c("baixo", "médio", "alto"), labels = c("1", "2", "3")))  #nível de umidade #1 = baixo, 2 = médio e 3 = alto
#nivel.temp <- cbind(teste[[3]])
#nivel.temp <- cbind(factor(as.factor(teste[[3]]), levels = c("21","42", "62"), labels = c("1","2", "3"))) #nível de temperatura
#nivel.temp <- cbind(as.integer(teste[[3]]))
#sem.germ <- cbind((teste[[4]])) #número de sementes germinadas depois de 5 dias
#dados <- data.frame(cbind(temp.germ, nivel.um, nivel.temp, sem.germ))
colnames(teste) <- c("temp.germ", "nivel.um", "nivel.temp", "sem.germ")
dados <- teste
dados$temp.germ <- as.factor(dados$temp.germ)
dados$nivel.um <- as.factor(dados$nivel.um)
dados$nivel.temp <- as.factor(dados$nivel.temp)
#dados$sem.germ <- as.numeric(dados$sem.germ)
sementes <-matrix(c(98,96,62,94,79,3,92,41,1,94,93,65,94,71,2,91,30,1),nrow=6,byrow=TRUE)
dimnames(sementes) <- list(c("11ºC & BAIXO","11ºC & MEDIO","11ºC & ALTO","21ºC & BAIXO","21ºC & MEDIO","21ºC & ALTO"),c("21ºC","42ºC", "62ºC"))
names(dimnames(sementes)) <- c("Temp. Germinação || Nível de umidade","Nível de temperatura")
#sementes
#xtable(sementes)
sementes_prop <-matrix(c(0.98,0.96,0.62,0.94,0.79,0.03,0.92,0.41,0.01,0.94,0.93,0.65,0.94,0.71,0.02,0.91,0.30,0.01),nrow=6,byrow=TRUE)
dimnames(sementes_prop) <- list(c("11ºC & BAIXO","11ºC & MEDIO","11ºC & ALTO","21ºC & BAIXO","21ºC & MEDIO","21ºC & ALTO"),c("21ºC","42ºC", "62ºC"))
names(dimnames(sementes_prop)) <- c("Temp. Germinação || Nível de umidade","Nível de temperatura")
#sementes
#xtable(sementes_prop)
prop.sem.germ <- dados$sem.germ/100
prop.sem.n.germ <- 1 - prop.sem.germ
sd.binom.caselas <- sqrt(prop.sem.germ*prop.sem.n.germ/100)
prop_sd <- cbind(prop.sem.germ, prop.sem.n.germ, sd.binom.caselas)
colnames(prop_sd) <- c("proporção de sementes germinadas", "proporção de sementes não germinadas", "sd")
dados <- cbind(dados, prop_sd)
ajuda <- dados %>% group_by(temp.germ,nivel.um) %>% summarise(medias=mean(sem.germ), DP = sd(sem.germ))
ajuda <- data.frame(ajuda)
cvs <- 100*ajuda$DP/ajuda$medias
med.resumo <- dados %>% group_by(temp.germ,nivel.um) %>% summarise(media = mean(sem.germ), vari = var(sem.germ), DP = sd(sem.germ), MAX = max(sem.germ), MIN = min(sem.germ))
med.resumo <- data.frame(med.resumo)
med.resumo <- cbind(med.resumo, cvs)
#med.resumo
#xtable(med.resumo)
a <- "Gráficos de perfil para temperatura de germinação à 11ºC. É perceptível que, para este perfil, com o aumento do nível de temperatura de umidade reduz-se a proporção estimada de sementes germinadas."
b <- "Gráfico de perfil para temperatura de germinação à 21ºC. É perceptível que, para este perfil, com o aumento do nível de temperatura de umidade reduz-se a proporção estimada de sementes germinadas."
c <- c(a,b)
plot(dados$`proporção de sementes germinadas`[1:3],axes=FALSE,ylim=c(0.0,1.0),cex.lab=.8,xlab="Nível de temperatura",ylab="Proporção de sementes germinadas", main = "Temperatura de germinação à 11ºC")
axis(2,cex.axis=.7)
axis(1,1:3,c("21ºC","42ºC", "62ºC"),cex.axis=.7)
plotCI(dados$`proporção de sementes germinadas`[1:3],liw=1.96*dados$`proporção de sementes germinadas`[1:3]*dados$sd[1:3],uiw=1.96*dados$`proporção de sementes germinadas`[1:3]*dados$sd[1:3],pch=19,add=TRUE,cex.lab=1.5,slty=1,lwd=0.8,col=4,cex=1)
lines(dados$`proporção de sementes germinadas`[1:3],lwd=0.8,col=4)
plotCI(dados$`proporção de sementes germinadas`[4:6],liw=1.96*dados$`proporção de sementes germinadas`[4:6]*dados$sd[4:6],uiw=1.96*dados$`proporção de sementes germinadas`[4:6]*dados$sd[4:6],pch=19,add=TRUE,cex.lab=1.5,slty=1,lwd=0.8,col=2,cex=1)
lines(dados$`proporção de sementes germinadas`[4:6],lwd=0.8,col=2)
plotCI(dados$`proporção de sementes germinadas`[7:9],liw=1.96*dados$`proporção de sementes germinadas`[7:9]*dados$sd[7:9],uiw=1.96*dados$`proporção de sementes germinadas`[7:9]*dados$sd[7:9],pch=19,add=TRUE,cex.lab=1.5,slty=1,lwd=0.8,col=1,cex=1)
lines(dados$`proporção de sementes germinadas`[7:9],lwd=0.8,col=1)
legend(1,0.3,col=c(4,2,1),lwd=c(2,2),pch=c(19,23),pt.bg=c(2,2),legend=c("Umidade baixa","Umidade média", "Umidade alta"),bty="n",cex=.5)
plot(dados$`proporção de sementes germinadas`[10:12],axes=FALSE,ylim=c(0.0,1.0),cex.lab=.8,xlab="Nível de temperatura",ylab="Proporção de sementes germinadas", main = "Temperatura de germinação à 21ºC")
axis(2,cex.axis=.7)
axis(1,1:3,c("21ºC","42ºC", "62ºC"),cex.axis=.7)
plotCI(dados$`proporção de sementes germinadas`[10:12],liw=1.96*dados$`proporção de sementes germinadas`[10:12]*dados$sd[10:12],uiw=1.96*dados$`proporção de sementes germinadas`[10:12]*dados$sd[10:12],pch=19,add=TRUE,cex.lab=1.5,slty=1,lwd=0.8,col=4,cex=1)
lines(dados$`proporção de sementes germinadas`[10:12],lwd=0.8,col=4)
plotCI(dados$`proporção de sementes germinadas`[13:15],liw=1.96*dados$`proporção de sementes germinadas`[13:15]*dados$sd[13:15],uiw=1.96*dados$`proporção de sementes germinadas`[13:15]*dados$sd[13:15],pch=19,add=TRUE,cex.lab=1.5,slty=1,lwd=0.8,col=2,cex=1)
lines(dados$`proporção de sementes germinadas`[13:15],lwd=0.8,col=2)
plotCI(dados$`proporção de sementes germinadas`[16:18],liw=1.96*dados$`proporção de sementes germinadas`[16:18]*dados$sd[16:18],uiw=1.96*dados$`proporção de sementes germinadas`[16:18]*dados$sd[16:18],pch=19,add=TRUE,cex.lab=1.5,slty=1,lwd=0.8,col=1,cex=1)
lines(dados$`proporção de sementes germinadas`[16:18],lwd=0.8,col=1)
legend(1,0.3,col=c(4,2,1),lwd=c(2,2),pch=c(19,23),pt.bg=c(2,2),legend=c("Umidade baixa","Umidade média", "Umidade alta"),bty="n",cex=.5)
plot(dados$`proporção de sementes germinadas`[1:3],axes=FALSE,ylim=c(0.0,1.0),cex.lab=.8,xlab="Nível de temperatura",ylab="Proporção de sementes germinadas", main = "Gráfico de perfil para umidade baixa")
axis(2,cex.axis=.7)
axis(1,1:3,c("21ºC","42ºC", "62ºC"),cex.axis=.7)
plotCI(dados$`proporção de sementes germinadas`[1:3],liw=1.96*dados$`proporção de sementes germinadas`[1:3]*dados$sd[1:3],uiw=1.96*dados$`proporção de sementes germinadas`[1:3]*dados$sd[1:3],pch=19,add=TRUE,cex.lab=1.5,slty=1,lwd=.8,col=4,cex=1)
lines(dados$`proporção de sementes germinadas`[1:3],lwd=.8,col=4)
plotCI(dados$`proporção de sementes germinadas`[10:12],liw=1.96*dados$`proporção de sementes germinadas`[10:12]*dados$sd[10:12],uiw=1.96*dados$`proporção de sementes germinadas`[10:12]*dados$sd[10:12],pch=19,add=TRUE,cex.lab=1.5,slty=1,lwd=.8,col=2,cex=1)
lines(dados$`proporção de sementes germinadas`[10:12],lwd=.8,col=2)
legend(1,0.3,col=c(4,2),lwd=c(2,2),pch=c(19,23),pt.bg=c(2,2),legend=c("Temperatura de germinação à 11ºC","Temperatura de germinação à 21ºC"),bty="n",cex=.5)
plot(dados$`proporção de sementes germinadas`[4:6],axes=FALSE,ylim=c(0.0,1.0),cex.lab=.8,xlab="Nível de temperatura",ylab="Proporção de sementes germinadas", main = "Gráfico de perfil para umidade média")
axis(2,cex.axis=.7)
axis(1,1:3,c("21ºC","42ºC", "62ºC"),cex.axis=.7)
plotCI(dados$`proporção de sementes germinadas`[4:6],liw=1.96*dados$`proporção de sementes germinadas`[4:6]*dados$sd[4:6],uiw=1.96*dados$`proporção de sementes germinadas`[4:6]*dados$sd[4:6],pch=19,add=TRUE,cex.lab=1.5,slty=1,lwd=.8,col=4,cex=1)
lines(dados$`proporção de sementes germinadas`[4:6],lwd=.8,col=4)
plotCI(dados$`proporção de sementes germinadas`[13:15],liw=1.96*dados$`proporção de sementes germinadas`[13:15]*dados$sd[13:15],uiw=1.96*dados$`proporção de sementes germinadas`[13:15]*dados$sd[13:15],pch=19,add=TRUE,cex.lab=1.5,slty=1,lwd=.8,col=2,cex=1)
lines(dados$`proporção de sementes germinadas`[13:15],lwd=.8,col=2)
legend(1,0.3,col=c(4,2),lwd=c(2,2),pch=c(19,23),pt.bg=c(2,2),legend=c("Temperatura de germinação à 11ºC","Temperatura de germinação à 21ºC"),bty="n",cex=.5)
plot(dados$`proporção de sementes germinadas`[7:9],axes=FALSE,ylim=c(0.0,1.0),cex.lab=.8,xlab="Nível de temperatura",ylab="Proporção de sementes germinadas", main = "Gráfico de perfil para umidade alta")
axis(2,cex.axis=.7)
axis(1,1:3,c("21ºC","42ºC", "62ºC"),cex.axis=.7)
plotCI(dados$`proporção de sementes germinadas`[7:9],liw=1.96*dados$`proporção de sementes germinadas`[7:9]*dados$sd[7:9],uiw=1.96*dados$`proporção de sementes germinadas`[7:9]*dados$sd[7:9],pch=19,add=TRUE,cex.lab=1.5,slty=1,lwd=.8,col=4,cex=1)
lines(dados$`proporção de sementes germinadas`[7:9],lwd=.8,col=4)
plotCI(dados$`proporção de sementes germinadas`[16:18],liw=1.96*dados$`proporção de sementes germinadas`[16:18]*dados$sd[16:18],uiw=1.96*dados$`proporção de sementes germinadas`[16:18]*dados$sd[16:18],pch=19,add=TRUE,cex.lab=1.5,slty=1,lwd=.8,col=2,cex=1)
lines(dados$`proporção de sementes germinadas`[16:18],lwd=.8,col=2)
legend(1,0.3,col=c(4,2),lwd=c(2,2),pch=c(19,23),pt.bg=c(2,2),legend=c("Temperatura de germinação à 11ºC","Temperatura de germinação à 21ºC"),bty="n",cex=.5)
coef(sem_binfit_mod3)
coef(sem_binfit_mod3)[1:7]
sum(coef(sem_binfit_mod3)[1:7])
eta1=sum(coef(sem_binfit_mod3)[1:7])
coef(sem_binfit_mod3)[c(1:2,6)]
eta2 = sum(coef(sem_binfit_mod3)[c(1:2,6)])
eta2
eta3 = sum(coef(sem_binfit_mod3)[c(1,6)])
eta3
eta4 = sum(coef(sem_binfit_mod3)[c(1,4,6)])
eta1
eta2
eta3
eta4
eta1 - eta2 + eta3 - eta4
coef(sem_binfit_mod3)[8]
coef(sem_binfit_mod3)
