m.C <- rbind(c(rep(0,15), 1, rep(0,6)), c(rep(0,16), 1, rep(0,5)), c(rep(0,17), 1, rep(0,4)), c(rep(0,18), 1, rep(0,3)), c(rep(0,19), 1, rep(0,2)), c(rep(0,20), 1, 0), c(rep(0,21), 1))
m.M <- cbind(rep(0, 7))
testeF.CBM.MLG(fit.model_1, m.C, m.M)
View(testeF.CBM.MLG)
m.C
m.M
summary(fit.model_1)
summary(fit.model_1)
m.C <- rbind(c(rep(0,15), 1, rep(0,8)), c(rep(0,16), 1, rep(0,7)), c(rep(0,17), 1, rep(0,6)), c(rep(0,18), 1, rep(0,5)), c(rep(0,19), 1, rep(0,4)), c(rep(0,20), 1, rep(0,3)), c(rep(0,21), 1, rep(0,2)), c(rep(0,22), 1, 0), c(rep(0,23), 1))
m.M <- cbind(rep(0, 9))
testeF.CBM.MLG(fit.model_1, m.C, m.M)
m.C <- rbind(c(rep(0,16), 1, rep(0,7)), c(rep(0,17), 1, rep(0,6)), c(rep(0,18), 1, rep(0,5)), c(rep(0,19), 1, rep(0,4)), c(rep(0,20), 1, rep(0,3)), c(rep(0,21), 1, rep(0,2)), c(rep(0,22), 1, 0), c(rep(0,23), 1))
m.M <- cbind(rep(0, 8))
testeF.CBM.MLG(fit.model_1, m.C, m.M)
m.C <- rbind(c(rep(0,17), 1, rep(0,6)), c(rep(0,18), 1, rep(0,5)), c(rep(0,19), 1, rep(0,4)), c(rep(0,20), 1, rep(0,3)), c(rep(0,21), 1, rep(0,2)), c(rep(0,22), 1, 0), c(rep(0,23), 1))
m.M <- cbind(rep(0, 7))
testeF.CBM.MLG(fit.model_1, m.C, m.M)
m.C <- rbind(c(rep(0,18), 1, rep(0,5)), c(rep(0,19), 1, rep(0,4)), c(rep(0,20), 1, rep(0,3)), c(rep(0,21), 1, rep(0,2)), c(rep(0,22), 1, 0), c(rep(0,23), 1))
m.M <- cbind(rep(0, 6))
testeF.CBM.MLG(fit.model_1, m.C, m.M)
m.C <- rbind(c(rep(0,17), 1, rep(0,6)), c(rep(0,18), 1, rep(0,5)), c(rep(0,19), 1, rep(0,4)), c(rep(0,20), 1, rep(0,3)), c(rep(0,21), 1, rep(0,2)), c(rep(0,22), 1, 0), c(rep(0,23), 1))
m.M <- cbind(rep(0, 7))
testeF.CBM.MLG(fit.model_1, m.C, m.M)
m.C <- rbind(c(rep(0,17), 1, rep(0,6)), c(rep(0,19), 1, rep(0,4)), c(rep(0,20), 1, rep(0,3)), c(rep(0,21), 1, rep(0,2)), c(rep(0,22), 1, 0), c(rep(0,23), 1))
m.M <- cbind(rep(0, 6))
testeF.CBM.MLG(fit.model_1, m.C, m.M)
m.C <- rbind(c(rep(0,17), 1, rep(0,6)), c(rep(0,18), 1, rep(0,5)), c(rep(0,20), 1, rep(0,3)), c(rep(0,21), 1, rep(0,2)), c(rep(0,22), 1, 0), c(rep(0,23), 1))
m.M <- cbind(rep(0, 6))
testeF.CBM.MLG(fit.model_1, m.C, m.M)
m.C <- rbind(c(rep(0,17), 1, rep(0,6)), c(rep(0,18), 1, rep(0,5)), c(rep(0,19), 1, rep(0,4)), c(rep(0,21), 1, rep(0,2)), c(rep(0,22), 1, 0), c(rep(0,23), 1))
m.M <- cbind(rep(0, 6))
testeF.CBM.MLG(fit.model_1, m.C, m.M)
m.C <- rbind(c(rep(0,17), 1, rep(0,6)), c(rep(0,18), 1, rep(0,5)), c(rep(0,19), 1, rep(0,4)), c(rep(0,20), 1, rep(0,3)), c(rep(0,21), 1, rep(0,2)), c(rep(0,22), 1, 0), c(rep(0,23), 1))
m.M <- cbind(rep(0, 7))
testeF.CBM.MLG(fit.model_1, m.C, m.M)
summary(fit.model_1)
m.C <- rbind(c(rep(0,17), 1, rep(0,6)), c(rep(0,19), 1, rep(0,4)), c(rep(0,20), 1, rep(0,3)), c(rep(0,21), 1, rep(0,2)), c(rep(0,23), 1))
m.M <- cbind(rep(0, 5))
testeF.CBM.MLG(fit.model_1, m.C, m.M)
summary(fit.model_1)
m.C <- rbind(c(rep(0,15), 1, rep(0,8)), c(rep(0,16), 1, rep(0,7)), c(rep(0,19), 1, rep(0,4)), c(rep(0,20), 1, rep(0,3)), c(rep(0,21), 1, rep(0,2)), c(rep(0,23), 1))
m.M <- cbind(rep(0, 6))
testeF.CBM.MLG(fit.model_1, m.C, m.M)
fit.model_2 <- glm(dados$`Nº de infecções` ~ dados$`Hab. de nadar`*dados$Local*dados$`Faixa etária` + dados$`Hab. de nadar`*dados$Local*dados$Sexo + dados$`Hab. de nadar`*dados$`Faixa etária`*dados$Sexo + dados$Local*dados$`Faixa etária`*dados$Sexo,family=poisson(link="log"),data=dados)
summary(fit.model_2)
diagPoisson(fit.model_2)
envelPoisson(fit.model_2, "log")
summary(fit.model_2)
envelPoisson(fit.model_2, "log")
summary(fit.model_2)
m.C <- rbind(c(rep(0,15), 1, rep(0,6)), c(rep(0,16), 1, rep(0,5)), c(rep(0,17), 1, rep(0,4)), c(rep(0,18), 1, rep(0,3)), c(rep(0,19), 1, rep(0,2)), c(rep(0,20), 1, 0), c(rep(0,21), 1))
m.M <- cbind(rep(0, 7))
testeF.CBM.MLG(fit.model_1, m.C, m.M)
m.C <- rbind(c(rep(0,15), 1, rep(0,6)), c(rep(0,16), 1, rep(0,5)), c(rep(0,17), 1, rep(0,4)), c(rep(0,18), 1, rep(0,3)), c(rep(0,19), 1, rep(0,2)), c(rep(0,20), 1, 0), c(rep(0,21), 1))
m.M <- cbind(rep(0, 7))
testeF.CBM.MLG(fit.model_2, m.C, m.M)
m.C <- rbind(c(rep(0,15), 1, rep(0,6)), c(rep(0,16), 1, rep(0,5)), c(rep(0,17), 1, rep(0,4)), c(rep(0,18), 1, rep(0,3)), c(rep(0,19), 1, rep(0,2)), c(rep(0,20), 1, 0))
m.M <- cbind(rep(0, 6))
testeF.CBM.MLG(fit.model_2, m.C, m.M)
summary(fit.model_2)
m.C <- rbind(c(rep(0,16), 1, rep(0,5)), c(rep(0,17), 1, rep(0,4)), c(rep(0,18), 1, rep(0,3)), c(rep(0,19), 1, rep(0,2)), c(rep(0,20), 1, 0), c(rep(0,21), 1))
m.M <- cbind(rep(0, 6))
testeF.CBM.MLG(fit.model_2, m.C, m.M)
summary(fit.model_2)
m.C <- rbind(c(rep(0,16), 1, rep(0,5)), c(rep(0,17), 1, rep(0,4)), c(rep(0,18), 1, rep(0,3)), c(rep(0,19), 1, rep(0,2)), c(rep(0,20), 1, 0), c(rep(0,21), 1))
summary(fit.model_2)
m.C <- rbind(c(rep(0,16), 1, rep(0,5)), c(rep(0,17), 1, rep(0,4)), c(rep(0,18), 1, rep(0,3)), c(rep(0,19), 1, rep(0,2)), c(rep(0,20), 1, 0), c(rep(0,21), 1))
#m.C <- rbind(c(rep(0,7), 1, rep(0,14)), c(rep(0,8), 1, rep(0,13)), c(rep(0,9), 1, rep(0,12)), c(rep(0,10), 1, rep(0,11)), c(rep(0,15), 1, rep(0,6)), c(rep(0,16), 1, rep(0,5)))
m.M <- cbind(rep(0, 6))
testeF.CBM.MLG(fit.model_2, m.C, m.M)
summary(fit.model_2)
m.C <- rbind(c(rep(0,16), 1, rep(0,5)), c(rep(0,17), 1, rep(0,4)), c(rep(0,18), 1, rep(0,3)), c(rep(0,19), 1, rep(0,2)), c(rep(0,20), 1, 0))
m.M <- cbind(rep(0, 5))
testeF.CBM.MLG(fit.model_2, m.C, m.M)
summary(fit.model_2)
fit.model_3 <- glm(dados$`Nº de infecções` ~ dados$Local*dados$`Faixa etária`*dados$Sexo,family=poisson(link="log"),data=dados)
fit.model_3 <- glm(dados$`Nº de infecções` ~ dados$Local*dados$`Faixa etária`*dados$Sexo,family=poisson(link="log"),data=dados)
summary(fit.model_3)
diagPoisson(fit.model_3)
envelPoisson(fit.model_3, "log")
summary(fit.model_3)
summary(fit.model_2)
m.C <- rbind(c(rep(0,16), 1, rep(0,5)), c(rep(0,17), 1, rep(0,4)), c(rep(0,18), 1, rep(0,3)), c(rep(0,19), 1, rep(0,2)), c(rep(0,20), 1, 0), c(rep(0,21), 1))
m.C <- rbind(c(rep(0,7), 1, rep(0,14)), c(rep(0,8), 1, rep(0,13)), c(rep(0,9), 1, rep(0,12)), c(rep(0,10), 1, rep(0,11)), c(rep(0,15), 1, rep(0,6)), c(rep(0,16), 1, rep(0,5)))
m.M <- cbind(rep(0, 6))
testeF.CBM.MLG(fit.model_2, m.C, m.M)
m.C <- rbind(c(rep(0,16), 1, rep(0,5)), c(rep(0,17), 1, rep(0,4)), c(rep(0,18), 1, rep(0,3)), c(rep(0,19), 1, rep(0,2)), c(rep(0,20), 1, 0), c(rep(0,21), 1))
m.M <- cbind(rep(0, 6))
testeF.CBM.MLG(fit.model_2, m.C, m.M)
m.C <- rbind(c(rep(0,16), 1, rep(0,5)), c(rep(0,17), 1, rep(0,4)), c(rep(0,18), 1, rep(0,3)), c(rep(0,19), 1, rep(0,2)), c(rep(0,20), 1, 0))
m.M <- cbind(rep(0, 5))
testeF.CBM.MLG(fit.model_2, m.C, m.M)
summary(fit.model_2)
m.C <- rbind(c(rep(0,16), 1, rep(0,5)), c(rep(0,17), 1, rep(0,4)), c(rep(0,18), 1, rep(0,3)), c(rep(0,19), 1, rep(0,2)), c(rep(0,20), 1, 0))
summary(fit.model_2)
m.C <- rbind(c(rep(0,15), 1, rep(0,6)), c(rep(0,16), 1, rep(0,5)), c(rep(0,17), 1, rep(0,4)), c(rep(0,18), 1, rep(0,3)), c(rep(0,19), 1, rep(0,2)))
summary(fit.model_2)
m.C <- rbind(c(rep(0,15), 1, rep(0,6)), c(rep(0,16), 1, rep(0,5)), c(rep(0,17), 1, rep(0,4)), c(rep(0,18), 1, rep(0,3)), c(rep(0,19), 1, rep(0,2)))
m.M <- cbind(rep(0, 5))
testeF.CBM.MLG(fit.model_2, m.C, m.M)
m.C <- rbind(c(rep(0,15), 1, rep(0,6)), c(rep(0,16), 1, rep(0,5)), c(rep(0,17), 1, rep(0,4)), c(rep(0,18), 1, rep(0,3)), c(rep(0,19), 1, rep(0,2)), c(rep(0,20), 1, rep(0,1)), c(rep(0,21), 1,))
m.C <- rbind(c(rep(0,15), 1, rep(0,6)), c(rep(0,16), 1, rep(0,5)), c(rep(0,17), 1, rep(0,4)), c(rep(0,18), 1, rep(0,3)), c(rep(0,19), 1, rep(0,2)), c(rep(0,20), 1, rep(0,1)), c(rep(0,21), 1))
m.M <- cbind(rep(0, 7))
testeF.CBM.MLG(fit.model_2, m.C, m.M)
m.C <- rbind(c(rep(0,15), 1, rep(0,6)), c(rep(0,16), 1, rep(0,5)), c(rep(0,17), 1, rep(0,4)), c(rep(0,18), 1, rep(0,3)), c(rep(0,19), 1, rep(0,2)))
m.M <- cbind(rep(0, 5))
testeF.CBM.MLG(fit.model_2, m.C, m.M)
summary(fit.model_2)
fit.model_3 <- glm(dados$`Nº de infecções` ~ dados$Local*dados$`Faixa etária`*dados$Sexo,family=poisson(link="log"),data=dados)
summary(fit.model_3)
m.C <- rbind(c(rep(0,7), 1, rep(0,4)), c(rep(0,8), 1, rep(0,3)), c(rep(0,9), 1, rep(0,2)), c(rep(0,10), 1, rep(0,1)), c(rep(0,11), 1))
m.M <- cbind(rep(0, 5))
summary(fit.model_3)
testeF.CBM.MLG(fit.model_3, m.C, m.M)
m.C <- rbind(c(rep(0,7), 1, rep(0,4)), c(rep(0,8), 1, rep(0,3)), c(rep(0,9), 1, rep(0,2)))
summary(fit.model_3)
m.C <- rbind(c(rep(0,7), 1, rep(0,4)), c(rep(0,8), 1, rep(0,3)), c(rep(0,9), 1, rep(0,2)))
m.M <- cbind(rep(0, 3))
testeF.CBM.MLG(fit.model_3, m.C, m.M)
summary(fit.model_3)
fit.model_3 <- glm(dados$`Nº de infecções` ~ dados$`Hab. de nadar`+ dados$Local*dados$`Faixa etária`*dados$Sexo,family=poisson(link="log"),data=dados)
summary(fit.model_3)
fit.model_3 <- glm(dados$`Nº de infecções` ~ dados$Local*dados$`Faixa etária`*dados$Sexo,family=poisson(link="log"),data=dados)
summary(fit.model_3)
m.C <- rbind(c(rep(0,7), 1, rep(0,4)), c(rep(0,8), 1, rep(0,3)), c(rep(0,9), 1, rep(0,2)))
m.M <- cbind(rep(0, 3))
testeF.CBM.MLG(fit.model_3, m.C, m.M)
summary(fit.model_3)
fit.model_4 <- glm(dados$`Nº de infecções` ~ dados$Local + dados$`Faixa etária` + dados$Sexo + dados$Local*dados$`Faixa etária` + dados$Local*dados$`Faixa etária`*dados$Sexo,family=poisson(link="log"),data=dados)
summary(fit.model_4)
diagPoisson(fit.model_4)
envelPoisson(fit.model_4, "log")
fit.model_1 <- glm(dados$`Nº de infecções` ~ dados$`Hab. de nadar`*dados$Local*dados$`Faixa etária`*dados$Sexo,family=poisson(link="log"),data=dados)
summary(fit.model_1)
fit.model_2 <- glm(dados$`Nº de infecções` ~ dados$`Hab. de nadar`*dados$Local*dados$`Faixa etária` + dados$`Hab. de nadar`*dados$Local*dados$Sexo + dados$`Hab. de nadar`*dados$`Faixa etária`*dados$Sexo + dados$Local*dados$`Faixa etária`*dados$Sexo,family=poisson(link="log"),data=dados)
summary(fit.model_2)
fit.model_3 <- glm(dados$`Nº de infecções` ~ dados$Local*dados$`Faixa etária`*dados$Sexo,family=poisson(link="log"),data=dados)
summary(fit.model_3)
summary(fit.model_3)
summary(fit.model_4)
fit.model_4 <- glm(dados$`Nº de infecções` ~ dados$Local + dados$`Faixa etária` + dados$Sexo + dados$Local*dados$`Faixa etária`,family=poisson(link="log"),data=dados)
summary(fit.model_4)
diagPoisson(fit.model_4)
envelPoisson(fit.model_4, "log")
fit.model_4 <- glm(dados$`Nº de infecções` ~ dados$Local + dados$`Faixa etária` + dados$Local*dados$`Faixa etária`,family=poisson(link="log"),data=dados)
summary(fit.model_4)
diagPoisson(fit.model_4)
envelPoisson(fit.model_4, "log")
summary(fit.model_4)
fit.model_3 <- glm(dados$`Nº de infecções` ~ dados$Local*dados$`Faixa etária`*dados$Sexo,family=poisson(link="log"),data=dados)
summary(fit.model_3)
fit.model_2 <- glm(dados$`Nº de infecções` ~ dados$`Hab. de nadar`*dados$Local*dados$`Faixa etária` + dados$`Hab. de nadar`*dados$Local*dados$Sexo + dados$`Hab. de nadar`*dados$`Faixa etária`*dados$Sexo + dados$Local*dados$`Faixa etária`*dados$Sexo,family=poisson(link="log"),data=dados)
summary(fit.model_2)
m.C <- rbind(c(rep(0,20), 1, 0), c(rep(0,21), 1))
m.M <- cbind(rep(0, 2))
testeF.CBM.MLG(fit.model_2, m.C, m.M)
summary(fit.model_2)
fit.model_2 <- glm(dados$`Nº de infecções` ~ dados$`Hab. de nadar`*dados$Local*dados$`Faixa etária` + dados$`Hab. de nadar`*dados$Local*dados$Sexo + dados$`Hab. de nadar`*dados$`Faixa etária`*dados$Sexo + dados$Local*dados$`Faixa etária`*dados$Sexo,family=poisson(link="log"),data=dados)
summary(fit.model_2)
fit.model_3 <- glm(dados$`Nº de infecções` ~ dados$Local*dados$`Faixa etária`*dados$Sexo,family=poisson(link="log"),data=dados)
summary(fit.model_3)
m.C <- rbind(c(rep(0,10), 1, 0), c(rep(0,11), 1))
m.M <- cbind(rep(0, 2))
testeF.CBM.MLG(fit.model_3, m.C, m.M)
fit.model_4 <- glm(dados$`Nº de infecções` ~ dados$Local + dados$`Faixa etária` + dados$Sexo + dados$`Hab. de nadar` ,family=poisson(link="log"),data=dados)
summary(fit.model_4)
diagPoisson(fit.model_4)
envelPoisson(fit.model_4, "log")
dados <- read.table("recrutas.dat")
fit.model_1 <- glm(dados$`Nº de infecções` ~ dados$`Hab. de nadar`*dados$Local*dados$`Faixa etária`*dados$Sexo,family=poisson(link="log"),data=dados)
summary(fit.model_1)
fit.model_2 <- glm(dados$`Nº de infecções` ~ dados$`Hab. de nadar`*dados$Local*dados$`Faixa etária` + dados$`Hab. de nadar`*dados$Local*dados$Sexo + dados$`Hab. de nadar`*dados$`Faixa etária`*dados$Sexo + dados$Local*dados$`Faixa etária`*dados$Sexo,family=poisson(link="log"),data=dados)
summary(fit.model_2)
diagPoisson(fit.model_2)
envelPoisson(fit.model_2, "log")
fit.model_3 <- glm(dados$`Nº de infecções` ~ dados$Local*dados$`Faixa etária`*dados$Sexo,family=poisson(link="log"),data=dados)
summary(fit.model_3)
diagPoisson(fit.model_3)
envelPoisson(fit.model_3, "log")
m.C <- rbind(c(rep(0,7), 1, rep(0,4)), c(rep(0,8), 1, rep(0,3)), c(rep(0,9), 1, rep(0,2)))
m.M <- cbind(rep(0, 3))
testeF.CBM.MLG(fit.model_3, m.C, m.M)
m.C <- rbind(c(rep(0,10), 1, 0), c(rep(0,11), 1))
m.M <- cbind(rep(0, 2))
testeF.CBM.MLG(fit.model_3, m.C, m.M)
fit.model_2 <- glm(dados$`Nº de infecções` ~ dados$`Hab. de nadar`*dados$Local*dados$`Faixa etária` + dados$`Hab. de nadar`*dados$Local*dados$Sexo + dados$`Hab. de nadar`*dados$`Faixa etária`*dados$Sexo + dados$Local*dados$`Faixa etária`*dados$Sexo,family=poisson(link="log"),data=dados)
summary(fit.model_2)
m.C <- rbind(c(rep(0,15), 1, rep(0,6)), c(rep(0,16), 1, rep(0,5)), c(rep(0,17), 1, rep(0,4)), c(rep(0,18), 1, rep(0,3)), c(rep(0,19), 1, rep(0,2)), c(rep(0,20), 1, 0), c(rep(0,21), 1))
m.M <- cbind(rep(0, 7))
testeF.CBM.MLG(fit.model_2, m.C, m.M)
?pchisq
summary(fit.model_2)
fit.model_3 <- glm(dados$`Nº de infecções` ~ dados$`Hab. de nadar`*dados$Local + dados$`Hab. de nadar`*dados$`Faixa etária` + dados$`Hab. de nadar`*dados$Sexo + dados$Local*dados$`Faixa etária` + dados$Local*dados$Sexo + dados$`Faixa etária`*dados$Sexo,family=poisson(link="log"),data=dados)
summary(fit.model_3)
m.C <- rbind(c(rep(0,13), 1, 0), c(rep(0,14), 1))
m.M <- cbind(rep(0, 2))
testeF.CBM.MLG(fit.model_3, m.C, m.M)
fit.model_4 <- glm(dados$`Nº de infecções` ~ dados$`Hab. de nadar`*dados$Local + dados$`Hab. de nadar`*dados$`Faixa etária` + dados$`Hab. de nadar`*dados$Sexo + dados$Local*dados$`Faixa etária` + dados$Local*dados$Sexo,family=poisson(link="log"),data=dados)
summary(fit.model_4)
fit.model_4 <- glm(dados$`Nº de infecções` ~ dados$`Hab. de nadar`*dados$Local + dados$`Hab. de nadar`*dados$`Faixa etária` + dados$Local*dados$`Faixa etária` + dados$Local*dados$Sexo,family=poisson(link="log"),data=dados)
summary(fit.model_4)
diagPoisson(fit.model_4)
envelPoisson(fit.model_4, "log")
fit.model_4 <- glm(dados$`Nº de infecções` ~ dados$`Hab. de nadar`*dados$Local + dados$`Hab. de nadar`*dados$`Faixa etária` + dados$`Hab. de nadar`*dados$Sexo + dados$Local*dados$`Faixa etária` + dados$Local*dados$Sexo,family=poisson(link="log"),data=dados)
summary(fit.model_4)
fit.model_4 <- glm(dados$`Nº de infecções` ~ dados$`Hab. de nadar`*dados$Local + dados$`Hab. de nadar`*dados$`Faixa etária` + dados$`Hab. de nadar`*dados$Sexo + dados$Local*dados$`Faixa etária` + dados$Local*dados$Sexo,family=poisson(link="log"),data=dados)
summary(fit.model_4)
fit.model_4 <- glm(dados$`Nº de infecções` ~ dados$`Hab. de nadar`*dados$Local + dados$`Hab. de nadar`*dados$`Faixa etária` + dados$Local*dados$`Faixa etária` + dados$Local*dados$Sexo,family=poisson(link="log"),data=dados)
summary(fit.model_4)
fit.model_3 <- glm(dados$`Nº de infecções` ~ dados$`Hab. de nadar`*dados$Local + dados$`Hab. de nadar`*dados$`Faixa etária` + dados$`Hab. de nadar`*dados$Sexo + dados$Local*dados$`Faixa etária` + dados$Local*dados$Sexo + dados$`Faixa etária`*dados$Sexo,family=poisson(link="log"),data=dados)
summary(fit.model_3)
m.C <- rbind(c(rep(0,13), 1, 0), c(rep(0,14), 1))
m.M <- cbind(rep(0, 2))
testeF.CBM.MLG(fit.model_3, m.C, m.M)
fit.model_4 <- glm(dados$`Nº de infecções` ~ dados$`Hab. de nadar`*dados$Local + dados$`Hab. de nadar`*dados$`Faixa etária` + dados$`Hab. de nadar`*dados$Sexo + dados$Local*dados$`Faixa etária` + dados$Local*dados$Sexo,family=poisson(link="log"),data=dados)
summary(fit.model_4)
m.C <- rbind(c(rep(0,6), 1, rep(0,6)), c(rep(0,9), 1, rep(0,3)))
m.C <- rbind(c(rep(0,6), 1, rep(0,6)), c(rep(0,9), 1, rep(0,3)))
m.M <- cbind(rep(0, 2))
testeF.CBM.MLG(fit.model_4, m.C, m.M)
summary(fit.model_4)
fit.model_4 <- glm(dados$`Nº de infecções` ~ dados$`Hab. de nadar`*dados$`Faixa etária` + dados$Local*dados$`Faixa etária` + dados$Local*dados$Sexo,family=poisson(link="log"),data=dados)
summary(fit.model_4)
diagPoisson(fit.model_4)
envelPoisson(fit.model_4, "log")
dados <- read.table("/home/hugo/Documentos/Discretos/discretos_2017/trabalho/TrabalhoME714/Parte02/recrutas.dat")
colnames(dados) <- c("Hab. de nadar", "Local", "Faixa etária", "Sexo", "Nº de infecções")
fit_max <- glm(`Nº de infecções`~ `Hab. de nadar` * `Local` * `Faixa etária` * `Sexo`,family=poisson(link="log"),data = dados)
fit_min <- glm(`Nº de infecções`~ 1,family=poisson(link="log"),data = dados)
step_min_to_max <- step(fit_min,scope = list(upper=fit_max),direction = "both")
step_max_to_min <- step(fit_max,scope = list(lower=fit_min),direction = "both")
source("codigos/envel_pois.R")
fit_step_min_to_max <- glm(`Nº de infecções` ~ `Hab. de nadar` + Local + `Faixa etária` + `Hab. de nadar`:`Faixa etária` + `Hab. de nadar`:Local + Local:`Faixa etária`, family=poisson(link="log"),data = dados)
library(xtable)
gerador_tbl_coef(fit_step_min_to_max)
getwd()
gerador_tbl_coef <- function(fit.model){
options(encoding="utf-8")
tabela <- summary(fit.model)$coefficients
tabela[,4] <- ifelse(tabela[,4] < 0.0001,"<0,0001",tabela[,4])
colnames(tabela) <- c("Estimativa","Erro Padrão","Estatística Z", "P-valor")
options(OutDec= ",")
return(xtable(tabela,digits = 4))
}
library(xtable)
gerador_tbl_coef(fit_step_min_to_max)
diagPoisson(fit_step_min_to_max)
envelPoisson(fit_step_min_to_max,"log")
fit_step_max_to_min <- glm(`Nº de infecções`~ `Hab. de nadar` * `Local` * `Faixa etária` * `Sexo`,family=poisson(link="log"),data = dados)
library(xtable)
gerador_tbl_coef(fit_step_max_to_min)
diagPoisson(fit_step_max_to_min)
envelPoisson(fit_step_max_to_min,"log")
# Testes do tipo H_0: CB=M vs H_1: CB <> M
# fit.model: sa?da do modelo ajustado
# m.C & m.M: matrizes de interesse
testeF.CBM.MLG <- function(fit.model,m.C,m.M)
{
v.beta <-  cbind(fit.model$coef)
e.q <- nrow(m.C)
m.cov.beta <- (vcov(fit.model))
e.Q <- t(m.C%*%v.beta-m.M)%*%solve(m.C%*%m.cov.beta%*%t(m.C))%*%(m.C%*%v.beta-m.M)
e.pvalor <- 1-pchisq(e.Q,e.q)
cat("Estatistica Q = ",round(e.Q,2),"\n")
cat("gl = ",e.q,"\n")
cat("pvalor = ",round(e.pvalor,4),"\n")
cat("Matriz C :","\n")
print(m.C)
cat("Matriz M :","\n")
print(m.M)
}
# fit.model 1: H_0
# fit.model 1: modelo irrestritro
TRV.MLG <- function(fit.model1,fit.model2)
{
ep <- ncol(model.matrix(fit.model2))
eq <- ep-ncol(model.matrix(fit.model1))
desv1 <- deviance(fit.model1)
desv2 <- deviance(fit.model2)
e.TRV <- (desv1-desv2)
e.pvalor <- 1-pchisq(e.TRV,eq)
cat("Estatistica F = ",round(e.TRV,2),"\n")
cat("g.l = ",eq,"\n")
cat("pvalor = ",round(e.pvalor,4),"\n")
}
# fit.model 1: H_0
# fit.model 1: modelo irrestritro
AnaDesv.MLG <- function(fit.model1,fit.model2)
{
ep <- ncol(model.matrix(fit.model2))
eq <- ep-ncol(model.matrix(fit.model1))
n <- nrow(model.matrix(fit.model2))
desv1 <- deviance(fit.model1)
desv2 <- deviance(fit.model2)
e.F <- ((desv1-desv2)/eq)/(desv2/(n-ep))
e.pvalor <- 1-pf(e.F,eq,n-ep)
cat("Estatistica F = ",round(e.F,2),"\n")
cat("pvalor = ",round(e.pvalor,4),"\n")
}
# Programa extra?do do site: https://www.ime.usp.br/~giapaula/textoregressao.htm
# Cr?ditos: Prof. Dr. Gilberto Alvarenga Paula
# Adaptado por Caio L. N. Azevedo
# source("D:\\windows\\Unicamp\\Disciplinas\\1_semestre_2016\\ME 720 MLG\\Programas\\diag_pois.r")
diagPoisson<-function(fit.model){
# fit.model: objeto com o resultado do ajuste do MLG obtido atrav?s da fun??o glm
X <- model.matrix(fit.model)
n <- nrow(X)
p <- ncol(X)
w <- fit.model$weights
W <- diag(w)
H <- solve(t(X)%*%W%*%X)
H <- sqrt(W)%*%X%*%H%*%t(X)%*%sqrt(W)
h <- diag(H)
ts <- resid(fit.model,type="pearson")/sqrt(1-h)
td <- resid(fit.model,type="deviance")/sqrt(1-h)
di <- (h/(1-h))*(ts^2)
par(mfrow=c(2,2))
a <- max(td)
b <- min(td)
plot(td,xlab="Índice", ylab="Resíduo Componente do Desvio",
ylim=c(b-1,a+1), pch=16,cex.axis=1.1,cex.lab=1.1,cex=1.1,cex.axis=1.1,cex.lab=1.1)
abline(2,0,lty=2)
abline(-2,0,lty=2)
abline(0,0,lty=2)
# identify(td, n=1)
# title(sub="(c)")
fited = fitted(fit.model)
plot(fited ,td,xlab="Valor ajustado (média)", ylab="Resíduo Componente do Desvio",ylim=c(b-1,a+1), pch=16,
main="",cex=1.1,cex.axis=1.1,cex.lab=1.1)
abline(2,0,lty=2)
abline(-2,0,lty=2)
abline(0,0,lty=2)
#
#hist(td,xlab="Res?duo Componente do Desvio",ylab="densidade",probability=TRUE,main="",cex=1.1,cex.axis=1.1,cex.lab=1.1)
#
eta = predict(fit.model)
z = eta + resid(fit.model, type="pearson")/sqrt(w)
plot(predict(fit.model),z,xlab="Preditor Linear",ylab="Variavel z", pch=16,main="",cex=1.1,cex.axis=1.1,cex.lab=1.1)
lines(smooth.spline(predict(fit.model), z, df=2))
#
#---------------------------------------------------------------#
}
#------------------------------------------------------------#
# Para rodar este programa  deixe no objeto fit.model a sa?da
# do  ajuste  da regress?o com  erros  Poisson e liga??o log.
# Programa extra?do do site: https://www.ime.usp.br/~giapaula/textoregressao.htm
# Cr?ditos: Prof. Dr. Gilberto Alvarenga Paula
# Adaptado por Caio L. N. Azevedo
# source("D:\\windows\\Unicamp\\Disciplinas\\1_semestre_2016\\ME 720 MLG\\Programas\\envel_Bern.r")
envelPoisson <- function(fit.model,ligacao){
# fit.model: objeto com o resultado do ajuste do MLG obtido atrav?s da fun??o glm
# ligacao: fun??o de liga??o (mesmo nome usado pela fun??o glm (colocar entre aspas)
#par(mfrow=c(1,1))
X <- model.matrix(fit.model)
n <- nrow(X)
p <- ncol(X)
w <- fit.model$weights
W <- diag(w)
H <- solve(t(X)%*%W%*%X)
H <- sqrt(W)%*%X%*%H%*%t(X)%*%sqrt(W)
h <- diag(H)
td <- resid(fit.model,type="deviance")/sqrt((1-h))
e <- matrix(0,n,100)
#
for(i in 1:100){
nresp <- rpois(n, fitted(fit.model))
fit <- glm(nresp ~ X, family=poisson(link=ligacao))
w <- fit$weights
W <- diag(w)
H <- solve(t(X)%*%W%*%X)
H <- sqrt(W)%*%X%*%H%*%t(X)%*%sqrt(W)
h <- diag(H)
e[,i] <- sort(resid(fit,type="deviance")/sqrt(1-h))}
#
e1 <- numeric(n)
e2 <- numeric(n)
#
for(i in 1:n){
eo <- sort(e[i,])
e1[i] <- (eo[2]+eo[3])/2
e2[i] <- (eo[97]+eo[98])/2}
#
med <- apply(e,1,mean)
faixa <- range(td,e1,e2)
#par(pty="s")
qqnorm(td,xlab="Percentil da N(0,1)",
ylab="Resíduo Componente do Desvio", ylim=faixa, pch=16,main="",cex=1.1,cex.axis=1.1,cex.lab=1.1)
#
par(new=T)
#
qqnorm(e1,axes=F,xlab="",ylab="",type="l",ylim=faixa,lty=1,main="")
par(new=T)
qqnorm(e2,axes=F,xlab="",ylab="", type="l",ylim=faixa,lty=1,main="")
par(new=T)
qqnorm(med,axes=F,xlab="", ylab="", type="l",ylim=faixa,lty=2,main="")
#------------------------------------------------------------#
}
# Testes do tipo H_0: CB=M vs H_1: CB <> M
# fit.model: sa?da do modelo ajustado
# m.C & m.M: matrizes de interesse
testeF.CBM.MLG <- function(fit.model,m.C,m.M)
{
v.beta <-  cbind(fit.model$coef)
e.q <- nrow(m.C)
m.cov.beta <- (vcov(fit.model))
e.Q <- t(m.C%*%v.beta-m.M)%*%solve(m.C%*%m.cov.beta%*%t(m.C))%*%(m.C%*%v.beta-m.M)
e.pvalor <- 1-pchisq(e.Q,e.q)
cat("Estatistica Q = ",round(e.Q,2),"\n")
cat("gl = ",e.q,"\n")
cat("pvalor = ",round(e.pvalor,4),"\n")
cat("Matriz C :","\n")
print(m.C)
cat("Matriz M :","\n")
print(m.M)
}
# fit.model 1: H_0
# fit.model 1: modelo irrestritro
TRV.MLG <- function(fit.model1,fit.model2)
{
ep <- ncol(model.matrix(fit.model2))
eq <- ep-ncol(model.matrix(fit.model1))
desv1 <- deviance(fit.model1)
desv2 <- deviance(fit.model2)
e.TRV <- (desv1-desv2)
e.pvalor <- 1-pchisq(e.TRV,eq)
cat("Estatistica F = ",round(e.TRV,2),"\n")
cat("g.l = ",eq,"\n")
cat("pvalor = ",round(e.pvalor,4),"\n")
}
# fit.model 1: H_0
# fit.model 1: modelo irrestritro
AnaDesv.MLG <- function(fit.model1,fit.model2)
{
ep <- ncol(model.matrix(fit.model2))
eq <- ep-ncol(model.matrix(fit.model1))
n <- nrow(model.matrix(fit.model2))
desv1 <- deviance(fit.model1)
desv2 <- deviance(fit.model2)
e.F <- ((desv1-desv2)/eq)/(desv2/(n-ep))
e.pvalor <- 1-pf(e.F,eq,n-ep)
cat("Estatistica F = ",round(e.F,2),"\n")
cat("pvalor = ",round(e.pvalor,4),"\n")
}
fit.model <- glm(dados$`Nº de infecções` ~ dados$`Hab. de nadar`*dados$Local*dados$`Faixa etária` + dados$`Hab. de nadar`*dados$`Faixa etária`*dados$Sexo + dados$Local*dados$`Faixa etária`*dados$Sexo,family=poisson(link="log"),data=dados)
#mudando o separador decimal para resultados "printados"
options(OutDec= ",")
#definindo opções padrões dos chunks
knitr::opts_chunk$set(fig.width=6, fig.height=3.5, fig.path='Figs/', fig.align='center', echo=FALSE, warning=FALSE, message=FALSE)
#mudando o separador decimal para resultados "printados"
options(OutDec= ",")
#definindo opções padrões dos chunks
knitr::opts_chunk$set(fig.width=6, fig.height=3.5, fig.path='Figs/', fig.align='center', echo=FALSE, warning=FALSE, message=FALSE)
library(dplyr)
library(xtable)
dados <- read.table("recrutas.dat")
colnames(dados) <- c("Hab. de nadar", "Local", "Faixa etária", "Sexo", "Nº de infecções")
#table(is.na(dados))
# table(dados$`Hab. de nadar`, dados$`Nº de infecções`)
# table(dados$Local, dados$`Nº de infecções`)
# table(dados$`Faixa etária`, dados$`Nº de infecções`)
# table(dados$Sexo, dados$`Nº de infecções`)
# dados %>% group_by(`Hab. de nadar`) %>% summarise(Cont_num_infec = sum(`Nº de infecções`))
# dados %>% group_by(Local) %>% summarise(Cont_num_infec = sum(`Nº de infecções`))
# dados %>% group_by(`Faixa etária`) %>% summarise(Cont_num_infec = sum(`Nº de infecções`))
# dados %>% group_by(Sexo) %>% summarise(Cont_num_infec = sum(`Nº de infecções`))
#
# xtable(dados %>% group_by(`Hab. de nadar`) %>% summarise(Cont_num_infec = sum(`Nº de infecções`)))
# xtable(dados %>% group_by(Local) %>% summarise(Cont_num_infec = sum(`Nº de infecções`)))
# xtable(dados %>% group_by(`Faixa etária`) %>% summarise(Cont_num_infec = sum(`Nº de infecções`)))
# xtable(dados %>% group_by(Sexo) %>% summarise(Cont_num_infec = sum(`Nº de infecções`)))
#dados %>% group_by(`Hab. de nadar`, Local) %>% summarise(Cont_num_infec = sum(`Nº de infecções`))
#dados %>% group_by(`Hab. de nadar`, Sexo) %>% summarise(Cont_num_infec = sum(`Nº de infecções`))
#número médio de infecções para indivíduos que tiveram pelo menos uma infecção, agrupdos pelo Local, Habito de nadar e sexo
#dados %>% group_by(Local, `Faixa etária`) %>% summarise(Num_medio_infec = mean(`Nº de infecções`))
#dados %>% group_by(`Hab. de nadar`, `Faixa etária`) %>% summarise(Num_medio_infec = mean(`Nº de infecções`))
#dados %>% group_by(Sexo, `Faixa etária`) %>% summarise(Num_medio_infec = mean(`Nº de infecções`))
fit.model <- glm(dados$`Nº de infecções` ~ dados$`Hab. de nadar`*dados$Local*dados$`Faixa etária` + dados$`Hab. de nadar`*dados$`Faixa etária`*dados$Sexo + dados$Local*dados$`Faixa etária`*dados$Sexo,family=poisson(link="log"),data=dados)
fit.model <- glm(dados$`Nº de infecções` ~ dados$`Hab. de nadar`*dados$Local*dados$`Faixa etária` + dados$`Hab. de nadar`*dados$`Faixa etária`*dados$Sexo + dados$Local*dados$`Faixa etária`*dados$Sexo,family=poisson(link="log"),data=dados)
summary(fit.model)
diagPoisson(fit.model)
envelPoisson(fit.model, "log")
summary(fit.model)
m.C <- rbind(c(rep(0,15), 1, rep(0,5)), c(rep(0,16), 1, rep(0,4)), c(rep(0,17), 1, rep(0,3)), c(rep(0,18), 1, rep(0,2)), c(rep(0,19), 1, rep(0,1)), c(rep(0,20), 1))
summary(fit.model)
m.C <- rbind(c(rep(0,15), 1, rep(0,5)), c(rep(0,16), 1, rep(0,4)), c(rep(0,17), 1, rep(0,3)), c(rep(0,18), 1, rep(0,2)), c(rep(0,19), 1, rep(0,1)), c(rep(0,20), 1))
m.M <- cbind(rep(0, 6))
testeF.CBM.MLG(fit.model, m.C, m.M)
summary(fit.model)
m.C <- rbind(c(rep(0,15), 1, rep(0,5)), c(rep(0,16), 1, rep(0,4)), c(rep(0,17), 1, rep(0,3)), c(rep(0,18), 1, rep(0,2)))
m.M <- cbind(rep(0, 4))
testeF.CBM.MLG(fit.model, m.C, m.M)
summary(fit.model)
fit.model <- glm(dados$`Nº de infecções` ~ dados$`Hab. de nadar`*dados$`Faixa etária`*dados$Sexo ,family=poisson(link="log"),data=dados)
summary(fit.model)
fit.model <- glm(dados$`Nº de infecções` ~ dados$`Hab. de nadar`*dados$Local*dados$`Faixa etária` + dados$`Hab. de nadar`*dados$`Faixa etária`*dados$Sexo + dados$Local*dados$`Faixa etária`*dados$Sexo,family=poisson(link="log"),data=dados)
summary(fit.model)
fit.model <- glm(dados$`Nº de infecções` ~ dados$`Hab. de nadar` + dados$Local + dados$`Faixa etária` + dados$Sexo + dados$`Hab. de nadar`*dados$Local + dados$`Hab. de nadar`*dados$`Faixa etária` + dados$`Hab. de nadar`*dados$Sexo +
dados$Local*dados$`Faixa etária` + dados$Local*dados$Sexo + dados$`Faixa etária`*dados$Sexo + dados$Local*dados$`Faixa etária`*dados$Sexo ,family=poisson(link="log"),data=dados)
summary(fit.model)
fit.model <- glm(dados$`Nº de infecções` ~ dados$`Hab. de nadar` + dados$Local + dados$`Faixa etária` + dados$Sexo + dados$`Hab. de nadar`*dados$Local + dados$`Hab. de nadar`*dados$`Faixa etária` + dados$`Hab. de nadar`*dados$Sexo +
dados$Local*dados$`Faixa etária` + dados$Local*dados$Sexo + dados$`Faixa etária`*dados$Sexo + dados$Local:dados$`Faixa etária`:dados$Sexo ,family=poisson(link="log"),data=dados)
summary(fit.model)
fit.model <- glm(dados$`Nº de infecções` ~ dados$`Hab. de nadar` + dados$Local + dados$`Faixa etária` + dados$Sexo + dados$`Hab. de nadar`*dados$Local + dados$`Hab. de nadar`*dados$`Faixa etária` + dados$`Hab. de nadar`*dados$Sexo +
dados$Local*dados$`Faixa etária` + dados$Local*dados$Sexo + dados$`Faixa etária`*dados$Sexo + dados$Local*dados$`Faixa etária`*dados$Sexo ,family=poisson(link="log"),data=dados)
summary(fit.model)
diagPoisson(fit.model)
envelPoisson(fit.model, "log")
summary(fit.model)
m.C <- rbind(c(rep(0,13), 1, rep(0,3)), c(rep(0,14), 1, rep(0,2)), c(rep(0,15), 1, rep(0,1)), c(rep(0,16), 1))
m.M <- cbind(rep(0, 4))
testeF.CBM.MLG(fit.model, m.C, m.M)
summary(fit.model)
