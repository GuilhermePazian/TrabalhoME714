c(rep(0,16), 1, rep(0,5))
rbind(c(rep(0,7), 1, rep(0,14)), c(rep(0,8), 1, rep(0,13)), c(rep(0,9), 1, rep(0,12)), c(rep(0,10), 1, rep(0,11)), c(rep(0,15), 1, rep(0,6)), c(rep(0,16), 1, rep(0,5)))
rep(0, 6)
cbind(rep(0, 6))
testeF.CBM.MLG(fit.model, m.C, m.M)
m.C <- rbind(c(rep(0,7), 1, rep(0,14)), c(rep(0,8), 1, rep(0,13)), c(rep(0,9), 1, rep(0,12)), c(rep(0,10), 1, rep(0,11)), c(rep(0,15), 1, rep(0,6)), c(rep(0,16), 1, rep(0,5)))
m.M <- cbind(rep(0, 6))
testeF.CBM.MLG(fit.model, m.C, m.M)
summary(fit.model)
rbind(c(rep(0,15), 1, rep(0,6)), c(rep(0,16), 1, rep(0,5)), c(rep(0,17), 1, rep(0,4)), c(rep(0,18), 1, rep(0,3)), c(rep(0,19), 1, rep(0,2)), c(rep(0,20), 1, 0))
rbind(c(rep(0,15), 1, rep(0,6)), c(rep(0,16), 1, rep(0,5)), c(rep(0,17), 1, rep(0,4)), c(rep(0,18), 1, rep(0,3)), c(rep(0,19), 1, rep(0,2)), c(rep(0,20), 1, 0), c(rep(0,21), 1))
m.C <- rbind(c(rep(0,15), 1, rep(0,6)), c(rep(0,16), 1, rep(0,5)), c(rep(0,17), 1, rep(0,4)), c(rep(0,18), 1, rep(0,3)), c(rep(0,19), 1, rep(0,2)), c(rep(0,20), 1, 0), c(rep(0,21), 1))
#m.C <- rbind(c(rep(0,7), 1, rep(0,14)), c(rep(0,8), 1, rep(0,13)), c(rep(0,9), 1, rep(0,12)), c(rep(0,10), 1, rep(0,11)), c(rep(0,15), 1, rep(0,6)), c(rep(0,16), 1, rep(0,5)))
m.M <- cbind(rep(0, 7))
testeF.CBM.MLG(fit.model, m.C, m.M)
summary(fit.model)
teste
teste <- glm(dados$`Nº de infecções` ~ dados$`Hab. de nadar`*dados$Local*dados$`Faixa etária`*dados$Sexo, family=poisson(link="log"),data=dados)
summary(teste)
coef(teste)
summary(teste)
rm
rm(teste)
fit.model <- glm(dados$`Nº de infecções` ~ dados$`Hab. de nadar`*dados$Local + dados$`Hab. de nadar`*dados$`Faixa etária` + dados$`Hab. de nadar`*dados$Sexo + dados$Local*dados$`Faixa etária` + dados$Local*dados$Sexo + dados$`Faixa etária`*dados$Sexo,family=poisson(link="log"),data=dados)
summary(fit.model)
saturado <- glm(dados$`Nº de infecções` ~ dados$`Hab. de nadar`*dados$Local*dados$`Faixa etária`*dados$Sexo, family=poisson(link="log"),data=dados)
summary(saturado)
source("codigos/envel_pois.r")
source("codigos/diag_pois.r")
# Programa extra?do do site: https://www.ime.usp.br/~giapaula/textoregressao.htm
# Cr?ditos: Prof. Dr. Gilberto Alvarenga Paula
# Adaptado por Caio L. N. Azevedo
# source("D:\\windows\\Unicamp\\Disciplinas\\1_semestre_2016\\ME 720 MLG\\Programas\\diag_pois.r")
diagPoisson<-function(fit.model){
# fit.model: objeto com o resultado do ajuste do MLG obtido atrav?s da fun??o glm
X <- model.matrix(fit.model)
n <- nrow(X)
p <- ncol(X)
w <- fit.model$weights
W <- diag(w)
H <- solve(t(X)%*%W%*%X)
H <- sqrt(W)%*%X%*%H%*%t(X)%*%sqrt(W)
h <- diag(H)
ts <- resid(fit.model,type="pearson")/sqrt(1-h)
td <- resid(fit.model,type="deviance")/sqrt(1-h)
di <- (h/(1-h))*(ts^2)
par(mfrow=c(2,2))
a <- max(td)
b <- min(td)
plot(td,xlab="Indice", ylab="Residuo Componente do Desvio",
ylim=c(b-1,a+1), pch=16,cex.axis=1.1,cex.lab=1.1,cex=1.1,cex.axis=1.1,cex.lab=1.1)
abline(2,0,lty=2)
abline(-2,0,lty=2)
abline(0,0,lty=2)
# identify(td, n=1)
# title(sub="(c)")
fited = fitted(fit.model)
plot(fited ,td,xlab="valor ajustado (m?dia)", ylab="Residuo Componente do Desvio",ylim=c(b-1,a+1), pch=16,
main="",cex=1.1,cex.axis=1.1,cex.lab=1.1)
abline(2,0,lty=2)
abline(-2,0,lty=2)
abline(0,0,lty=2)
#
hist(td,xlab="Res?duo Componente do Desvio",ylab="densidade",probability=TRUE,main="",cex=1.1,cex.axis=1.1,cex.lab=1.1)
#
eta = predict(fit.model)
z = eta + resid(fit.model, type="pearson")/sqrt(w)
plot(predict(fit.model),z,xlab="Preditor Linear",ylab="Variavel z", pch=16,main="",cex=1.1,cex.axis=1.1,cex.lab=1.1)
lines(smooth.spline(predict(fit.model), z, df=2))
#
#---------------------------------------------------------------#
}
#------------------------------------------------------------#
# Para rodar este programa  deixe no objeto fit.model a sa?da
# do  ajuste  da regress?o com  erros  Poisson e liga??o log.
# Programa extra?do do site: https://www.ime.usp.br/~giapaula/textoregressao.htm
# Cr?ditos: Prof. Dr. Gilberto Alvarenga Paula
# Adaptado por Caio L. N. Azevedo
# source("D:\\windows\\Unicamp\\Disciplinas\\1_semestre_2016\\ME 720 MLG\\Programas\\envel_Bern.r")
envelPoisson <- function(fit.model,ligacao){
# fit.model: objeto com o resultado do ajuste do MLG obtido atrav?s da fun??o glm
# ligacao: fun??o de liga??o (mesmo nome usado pela fun??o glm (colocar entre aspas)
#par(mfrow=c(1,1))
X <- model.matrix(fit.model)
n <- nrow(X)
p <- ncol(X)
w <- fit.model$weights
W <- diag(w)
H <- solve(t(X)%*%W%*%X)
H <- sqrt(W)%*%X%*%H%*%t(X)%*%sqrt(W)
h <- diag(H)
td <- resid(fit.model,type="deviance")/sqrt((1-h))
e <- matrix(0,n,100)
#
for(i in 1:100){
nresp <- rpois(n, fitted(fit.model))
fit <- glm(nresp ~ X, family=poisson(link=ligacao))
w <- fit$weights
W <- diag(w)
H <- solve(t(X)%*%W%*%X)
H <- sqrt(W)%*%X%*%H%*%t(X)%*%sqrt(W)
h <- diag(H)
e[,i] <- sort(resid(fit,type="deviance")/sqrt(1-h))}
#
e1 <- numeric(n)
e2 <- numeric(n)
#
for(i in 1:n){
eo <- sort(e[i,])
e1[i] <- (eo[2]+eo[3])/2
e2[i] <- (eo[97]+eo[98])/2}
#
med <- apply(e,1,mean)
faixa <- range(td,e1,e2)
#par(pty="s")
qqnorm(td,xlab="Percentil da N(0,1)",
ylab="Res?duo Componente do Desvio", ylim=faixa, pch=16,main="",cex=1.1,cex.axis=1.1,cex.lab=1.1)
#
par(new=T)
#
qqnorm(e1,axes=F,xlab="",ylab="",type="l",ylim=faixa,lty=1,main="")
par(new=T)
qqnorm(e2,axes=F,xlab="",ylab="", type="l",ylim=faixa,lty=1,main="")
par(new=T)
qqnorm(med,axes=F,xlab="", ylab="", type="l",ylim=faixa,lty=2,main="")
#------------------------------------------------------------#
}
source("codigos/envel_pois.r")
source("codigos/diag_pois.r")
source("codigos/TestesMRDD.r")
library(plotrix)
source("codigos/envel_pois.r")
diagPoisson(saturado)
diagPoisson(saturado)
diagPoisson(saturado)
envelPoisson(saturado)
envelPoisson(saturado, "log")
diagPoisson(saturado)
diagPoisson(fit.model)
envelPoisson(fit.model, "log")
# Programa extra?do do site: https://www.ime.usp.br/~giapaula/textoregressao.htm
# Cr?ditos: Prof. Dr. Gilberto Alvarenga Paula
# Adaptado por Caio L. N. Azevedo
# source("D:\\windows\\Unicamp\\Disciplinas\\1_semestre_2016\\ME 720 MLG\\Programas\\diag_pois.r")
diagPoisson<-function(fit.model){
# fit.model: objeto com o resultado do ajuste do MLG obtido atrav?s da fun??o glm
X <- model.matrix(fit.model)
n <- nrow(X)
p <- ncol(X)
w <- fit.model$weights
W <- diag(w)
H <- solve(t(X)%*%W%*%X)
H <- sqrt(W)%*%X%*%H%*%t(X)%*%sqrt(W)
h <- diag(H)
ts <- resid(fit.model,type="pearson")/sqrt(1-h)
td <- resid(fit.model,type="deviance")/sqrt(1-h)
di <- (h/(1-h))*(ts^2)
par(mfrow=c(2,2))
a <- max(td)
b <- min(td)
plot(td,xlab="Indice", ylab="Residuo Componente do Desvio",
ylim=c(b-1,a+1), pch=16,cex.axis=1.1,cex.lab=1.1,cex=1.1,cex.axis=1.1,cex.lab=1.1)
abline(2,0,lty=2)
abline(-2,0,lty=2)
abline(0,0,lty=2)
# identify(td, n=1)
# title(sub="(c)")
fited = fitted(fit.model)
plot(fited ,td,xlab="valor ajustado (m?dia)", ylab="Residuo Componente do Desvio",ylim=c(b-1,a+1), pch=16,
main="",cex=1.1,cex.axis=1.1,cex.lab=1.1)
abline(2,0,lty=2)
abline(-2,0,lty=2)
abline(0,0,lty=2)
#
#hist(td,xlab="Res?duo Componente do Desvio",ylab="densidade",probability=TRUE,main="",cex=1.1,cex.axis=1.1,cex.lab=1.1)
#
eta = predict(fit.model)
z = eta + resid(fit.model, type="pearson")/sqrt(w)
plot(predict(fit.model),z,xlab="Preditor Linear",ylab="Variavel z", pch=16,main="",cex=1.1,cex.axis=1.1,cex.lab=1.1)
lines(smooth.spline(predict(fit.model), z, df=2))
#
#---------------------------------------------------------------#
}
# Programa extra?do do site: https://www.ime.usp.br/~giapaula/textoregressao.htm
# Cr?ditos: Prof. Dr. Gilberto Alvarenga Paula
# Adaptado por Caio L. N. Azevedo
# source("D:\\windows\\Unicamp\\Disciplinas\\1_semestre_2016\\ME 720 MLG\\Programas\\diag_pois.r")
diagPoisson<-function(fit.model){
# fit.model: objeto com o resultado do ajuste do MLG obtido atrav?s da fun??o glm
X <- model.matrix(fit.model)
n <- nrow(X)
p <- ncol(X)
w <- fit.model$weights
W <- diag(w)
H <- solve(t(X)%*%W%*%X)
H <- sqrt(W)%*%X%*%H%*%t(X)%*%sqrt(W)
h <- diag(H)
ts <- resid(fit.model,type="pearson")/sqrt(1-h)
td <- resid(fit.model,type="deviance")/sqrt(1-h)
di <- (h/(1-h))*(ts^2)
par(mfrow=c(2,2))
a <- max(td)
b <- min(td)
plot(td,xlab="Índice", ylab="Resíduo Componente do Desvio",
ylim=c(b-1,a+1), pch=16,cex.axis=1.1,cex.lab=1.1,cex=1.1,cex.axis=1.1,cex.lab=1.1)
abline(2,0,lty=2)
abline(-2,0,lty=2)
abline(0,0,lty=2)
# identify(td, n=1)
# title(sub="(c)")
fited = fitted(fit.model)
plot(fited ,td,xlab="Valor ajustado (média)", ylab="Resíduo Componente do Desvio",ylim=c(b-1,a+1), pch=16,
main="",cex=1.1,cex.axis=1.1,cex.lab=1.1)
abline(2,0,lty=2)
abline(-2,0,lty=2)
abline(0,0,lty=2)
#
#hist(td,xlab="Res?duo Componente do Desvio",ylab="densidade",probability=TRUE,main="",cex=1.1,cex.axis=1.1,cex.lab=1.1)
#
eta = predict(fit.model)
z = eta + resid(fit.model, type="pearson")/sqrt(w)
plot(predict(fit.model),z,xlab="Preditor Linear",ylab="Variavel z", pch=16,main="",cex=1.1,cex.axis=1.1,cex.lab=1.1)
lines(smooth.spline(predict(fit.model), z, df=2))
#
#---------------------------------------------------------------#
}
#------------------------------------------------------------#
# Para rodar este programa  deixe no objeto fit.model a sa?da
# do  ajuste  da regress?o com  erros  Poisson e liga??o log.
# Programa extra?do do site: https://www.ime.usp.br/~giapaula/textoregressao.htm
# Cr?ditos: Prof. Dr. Gilberto Alvarenga Paula
# Adaptado por Caio L. N. Azevedo
# source("D:\\windows\\Unicamp\\Disciplinas\\1_semestre_2016\\ME 720 MLG\\Programas\\envel_Bern.r")
envelPoisson <- function(fit.model,ligacao){
# fit.model: objeto com o resultado do ajuste do MLG obtido atrav?s da fun??o glm
# ligacao: fun??o de liga??o (mesmo nome usado pela fun??o glm (colocar entre aspas)
#par(mfrow=c(1,1))
X <- model.matrix(fit.model)
n <- nrow(X)
p <- ncol(X)
w <- fit.model$weights
W <- diag(w)
H <- solve(t(X)%*%W%*%X)
H <- sqrt(W)%*%X%*%H%*%t(X)%*%sqrt(W)
h <- diag(H)
td <- resid(fit.model,type="deviance")/sqrt((1-h))
e <- matrix(0,n,100)
#
for(i in 1:100){
nresp <- rpois(n, fitted(fit.model))
fit <- glm(nresp ~ X, family=poisson(link=ligacao))
w <- fit$weights
W <- diag(w)
H <- solve(t(X)%*%W%*%X)
H <- sqrt(W)%*%X%*%H%*%t(X)%*%sqrt(W)
h <- diag(H)
e[,i] <- sort(resid(fit,type="deviance")/sqrt(1-h))}
#
e1 <- numeric(n)
e2 <- numeric(n)
#
for(i in 1:n){
eo <- sort(e[i,])
e1[i] <- (eo[2]+eo[3])/2
e2[i] <- (eo[97]+eo[98])/2}
#
med <- apply(e,1,mean)
faixa <- range(td,e1,e2)
#par(pty="s")
qqnorm(td,xlab="Percentil da N(0,1)",
ylab="Resíduo Componente do Desvio", ylim=faixa, pch=16,main="",cex=1.1,cex.axis=1.1,cex.lab=1.1)
#
par(new=T)
#
qqnorm(e1,axes=F,xlab="",ylab="",type="l",ylim=faixa,lty=1,main="")
par(new=T)
qqnorm(e2,axes=F,xlab="",ylab="", type="l",ylim=faixa,lty=1,main="")
par(new=T)
qqnorm(med,axes=F,xlab="", ylab="", type="l",ylim=faixa,lty=2,main="")
#------------------------------------------------------------#
}
testeF.CBM.MLG <- function(fit.model,m.C,m.M)
{
v.beta <-  cbind(fit.model$coef)
e.q <- nrow(m.C)
m.cov.beta <- (vcov(fit.model))
e.Q <- t(m.C%*%v.beta-m.M)%*%solve(m.C%*%m.cov.beta%*%t(m.C))%*%(m.C%*%v.beta-m.M)
e.pvalor <- 1-pchisq(e.Q,e.q)
cat("Estatistica Q = ",round(e.Q,2),"\n")
cat("gl = ",e.q,"\n")
cat("pvalor = ",round(e.pvalor,4),"\n")
cat("Matriz C :","\n")
print(m.C)
cat("Matriz M :","\n")
print(m.M)
}
TRV.MLG <- function(fit.model1,fit.model2)
{
ep <- ncol(model.matrix(fit.model2))
eq <- ep-ncol(model.matrix(fit.model1))
desv1 <- deviance(fit.model1)
desv2 <- deviance(fit.model2)
e.TRV <- (desv1-desv2)
e.pvalor <- 1-pchisq(e.TRV,eq)
cat("Estatistica F = ",round(e.TRV,2),"\n")
cat("g.l = ",eq,"\n")
cat("pvalor = ",round(e.pvalor,4),"\n")
}
AnaDesv.MLG <- function(fit.model1,fit.model2)
{
ep <- ncol(model.matrix(fit.model2))
eq <- ep-ncol(model.matrix(fit.model1))
n <- nrow(model.matrix(fit.model2))
desv1 <- deviance(fit.model1)
desv2 <- deviance(fit.model2)
e.F <- ((desv1-desv2)/eq)/(desv2/(n-ep))
e.pvalor <- 1-pf(e.F,eq,n-ep)
cat("Estatistica F = ",round(e.F,2),"\n")
cat("pvalor = ",round(e.pvalor,4),"\n")
}
diagPoisson<-function(fit.model){
# fit.model: objeto com o resultado do ajuste do MLG obtido através da função glm
X <- model.matrix(fit.model)
n <- nrow(X)
p <- ncol(X)
w <- fit.model$weights
W <- diag(w)
H <- solve(t(X)%*%W%*%X)
H <- sqrt(W)%*%X%*%H%*%t(X)%*%sqrt(W)
h <- diag(H)
ts <- resid(fit.model,type="pearson")/sqrt(1-h)
td <- resid(fit.model,type="deviance")/sqrt(1-h)
di <- (h/(1-h))*(ts^2)
par(mfrow=c(2,2))
a <- max(td)
b <- min(td)
plot(td,xlab="Índice", ylab="Resíduo Componente do Desvio",
ylim=c(b-1,a+1), pch=16,cex.axis=1.1,cex.lab=1.1,cex=1.1,cex.axis=1.1,cex.lab=1.1)
abline(2,0,lty=2)
abline(-2,0,lty=2)
abline(0,0,lty=2)
# identify(td, n=1)
# title(sub="(c)")
fited = fitted(fit.model)
plot(fited ,td,xlab="Valor ajustado (média)", ylab="Resíduo Componente do Desvio",ylim=c(b-1,a+1), pch=16,
main="",cex=1.1,cex.axis=1.1,cex.lab=1.1)
abline(2,0,lty=2)
abline(-2,0,lty=2)
abline(0,0,lty=2)
#
eta = predict(fit.model)
z = eta + resid(fit.model, type="pearson")/sqrt(w)
plot(predict(fit.model),z,xlab="Preditor Linear",ylab="Variavel z", pch=16,main="",cex=1.1,cex.axis=1.1,cex.lab=1.1)
lines(smooth.spline(predict(fit.model), z, df=2))
}
envelPoisson <- function(fit.model,ligacao){
# fit.model: objeto com o resultado do ajuste do MLG obtido através da função glm
# ligacao: função de ligação (mesmo nome usado pela função glm (colocar entre aspas)
#par(mfrow=c(1,1))
X <- model.matrix(fit.model)
n <- nrow(X)
p <- ncol(X)
w <- fit.model$weights
W <- diag(w)
H <- solve(t(X)%*%W%*%X)
H <- sqrt(W)%*%X%*%H%*%t(X)%*%sqrt(W)
h <- diag(H)
td <- resid(fit.model,type="deviance")/sqrt((1-h))
e <- matrix(0,n,100)
#
for(i in 1:100){
nresp <- rpois(n, fitted(fit.model))
fit <- glm(nresp ~ X, family=poisson(link=ligacao))
w <- fit$weights
W <- diag(w)
H <- solve(t(X)%*%W%*%X)
H <- sqrt(W)%*%X%*%H%*%t(X)%*%sqrt(W)
h <- diag(H)
e[,i] <- sort(resid(fit,type="deviance")/sqrt(1-h))}
#
e1 <- numeric(n)
e2 <- numeric(n)
#
for(i in 1:n){
eo <- sort(e[i,])
e1[i] <- (eo[2]+eo[3])/2
e2[i] <- (eo[97]+eo[98])/2}
#
med <- apply(e,1,mean)
faixa <- range(td,e1,e2)
#par(pty="s")
qqnorm(td,xlab="Percentil da N(0,1)",
ylab="Resíduo Componente do Desvio", ylim=faixa, pch=16,main="",cex=1.1,cex.axis=1.1,cex.lab=1.1)
#
par(new=T)
#
qqnorm(e1,axes=F,xlab="",ylab="",type="l",ylim=faixa,lty=1,main="")
par(new=T)
qqnorm(e2,axes=F,xlab="",ylab="", type="l",ylim=faixa,lty=1,main="")
par(new=T)
qqnorm(med,axes=F,xlab="", ylab="", type="l",ylim=faixa,lty=2,main="")
}
fit.model <- glm(dados$`Nº de infecções` ~ dados$`Hab. de nadar`*dados$Local*dados$`Faixa etária`*dados$Sexo,family=poisson(link="log"),data=dados)
summary(fit.model)
source("codigos/TestesMRDD.r")
# source("codigos/envel_pois.r")
# source("codigos/diag_pois.r")
fit.model <- glm(dados$`Nº de infecções` ~ dados$`Hab. de nadar`*dados$Local*dados$`Faixa etária`*dados$Sexo,family=poisson(link="log"),data=dados)
summary(fit.model)
diagPoisson(fit.model)
envelPoisson(fit.model, "log")
#m.C <- rbind(c(rep(0,15), 1, rep(0,6)), c(rep(0,16), 1, rep(0,5)), c(rep(0,17), 1, rep(0,4)), c(rep(0,18), 1, rep(0,3)), c(rep(0,19), 1, rep(0,2)), c(rep(0,20), 1, 0), c(rep(0,21), 1))
#m.C <- rbind(c(rep(0,7), 1, rep(0,14)), c(rep(0,8), 1, rep(0,13)), c(rep(0,9), 1, rep(0,12)), c(rep(0,10), 1, rep(0,11)), c(rep(0,15), 1, rep(0,6)), c(rep(0,16), 1, rep(0,5)))
#m.M <- cbind(rep(0, 7))
#testeF.CBM.MLG(fit.model, m.C, m.M)
summary(fit.model)
source("codigos/TestesMRDD.r")
# source("codigos/envel_pois.r")
# source("codigos/diag_pois.r")
fit.model <- glm(dados$`Nº de infecções` ~ dados$`Hab. de nadar`*dados$Local*dados$`Faixa etária`*dados$Sexo,family=poisson(link="log"),data=dados)
summary(fit.model)
diagPoisson(fit.model)
envelPoisson(fit.model, "log")
#m.C <- rbind(c(rep(0,15), 1, rep(0,6)), c(rep(0,16), 1, rep(0,5)), c(rep(0,17), 1, rep(0,4)), c(rep(0,18), 1, rep(0,3)), c(rep(0,19), 1, rep(0,2)), c(rep(0,20), 1, 0), c(rep(0,21), 1))
#m.C <- rbind(c(rep(0,7), 1, rep(0,14)), c(rep(0,8), 1, rep(0,13)), c(rep(0,9), 1, rep(0,12)), c(rep(0,10), 1, rep(0,11)), c(rep(0,15), 1, rep(0,6)), c(rep(0,16), 1, rep(0,5)))
#m.M <- cbind(rep(0, 7))
#testeF.CBM.MLG(fit.model, m.C, m.M)
rm(fit.model)
summary(fit.model_1)
fit.model_1 <- glm(dados$`Nº de infecções` ~ dados$`Hab. de nadar`*dados$Local*dados$`Faixa etária`*dados$Sexo,family=poisson(link="log"),data=dados)
summary(fit.model_1)
m.C <- rbind(c(rep(0,15), 1, rep(0,6)), c(rep(0,16), 1, rep(0,5)), c(rep(0,17), 1, rep(0,4)), c(rep(0,18), 1, rep(0,3)), c(rep(0,19), 1, rep(0,2)), c(rep(0,20), 1, 0), c(rep(0,21), 1))
View(m.C)
m.M <- cbind(rep(0, 7))
testeF.CBM.MLG(fit.model, m.C, m.M)
testeF.CBM.MLG(fit.model_1, m.C, m.M)
fit.model_1 <- glm(dados$`Nº de infecções` ~ dados$`Hab. de nadar`*dados$Local*dados$`Faixa etária`*dados$Sexo,family=poisson(link="log"),data=dados)
m.C <- rbind(c(rep(0,15), 1, rep(0,6)), c(rep(0,16), 1, rep(0,5)), c(rep(0,17), 1, rep(0,4)), c(rep(0,18), 1, rep(0,3)), c(rep(0,19), 1, rep(0,2)), c(rep(0,20), 1, 0), c(rep(0,21), 1))
m.M <- cbind(rep(0, 7))
testeF.CBM.MLG(fit.model_1, m.C, m.M)
View(testeF.CBM.MLG)
m.C
m.M
summary(fit.model_1)
summary(fit.model_1)
m.C <- rbind(c(rep(0,15), 1, rep(0,8)), c(rep(0,16), 1, rep(0,7)), c(rep(0,17), 1, rep(0,6)), c(rep(0,18), 1, rep(0,5)), c(rep(0,19), 1, rep(0,4)), c(rep(0,20), 1, rep(0,3)), c(rep(0,21), 1, rep(0,2)), c(rep(0,22), 1, 0), c(rep(0,23), 1))
m.M <- cbind(rep(0, 9))
testeF.CBM.MLG(fit.model_1, m.C, m.M)
m.C <- rbind(c(rep(0,16), 1, rep(0,7)), c(rep(0,17), 1, rep(0,6)), c(rep(0,18), 1, rep(0,5)), c(rep(0,19), 1, rep(0,4)), c(rep(0,20), 1, rep(0,3)), c(rep(0,21), 1, rep(0,2)), c(rep(0,22), 1, 0), c(rep(0,23), 1))
m.M <- cbind(rep(0, 8))
testeF.CBM.MLG(fit.model_1, m.C, m.M)
m.C <- rbind(c(rep(0,17), 1, rep(0,6)), c(rep(0,18), 1, rep(0,5)), c(rep(0,19), 1, rep(0,4)), c(rep(0,20), 1, rep(0,3)), c(rep(0,21), 1, rep(0,2)), c(rep(0,22), 1, 0), c(rep(0,23), 1))
m.M <- cbind(rep(0, 7))
testeF.CBM.MLG(fit.model_1, m.C, m.M)
m.C <- rbind(c(rep(0,18), 1, rep(0,5)), c(rep(0,19), 1, rep(0,4)), c(rep(0,20), 1, rep(0,3)), c(rep(0,21), 1, rep(0,2)), c(rep(0,22), 1, 0), c(rep(0,23), 1))
m.M <- cbind(rep(0, 6))
testeF.CBM.MLG(fit.model_1, m.C, m.M)
m.C <- rbind(c(rep(0,17), 1, rep(0,6)), c(rep(0,18), 1, rep(0,5)), c(rep(0,19), 1, rep(0,4)), c(rep(0,20), 1, rep(0,3)), c(rep(0,21), 1, rep(0,2)), c(rep(0,22), 1, 0), c(rep(0,23), 1))
m.M <- cbind(rep(0, 7))
testeF.CBM.MLG(fit.model_1, m.C, m.M)
m.C <- rbind(c(rep(0,17), 1, rep(0,6)), c(rep(0,19), 1, rep(0,4)), c(rep(0,20), 1, rep(0,3)), c(rep(0,21), 1, rep(0,2)), c(rep(0,22), 1, 0), c(rep(0,23), 1))
m.M <- cbind(rep(0, 6))
testeF.CBM.MLG(fit.model_1, m.C, m.M)
m.C <- rbind(c(rep(0,17), 1, rep(0,6)), c(rep(0,18), 1, rep(0,5)), c(rep(0,20), 1, rep(0,3)), c(rep(0,21), 1, rep(0,2)), c(rep(0,22), 1, 0), c(rep(0,23), 1))
m.M <- cbind(rep(0, 6))
testeF.CBM.MLG(fit.model_1, m.C, m.M)
m.C <- rbind(c(rep(0,17), 1, rep(0,6)), c(rep(0,18), 1, rep(0,5)), c(rep(0,19), 1, rep(0,4)), c(rep(0,21), 1, rep(0,2)), c(rep(0,22), 1, 0), c(rep(0,23), 1))
m.M <- cbind(rep(0, 6))
testeF.CBM.MLG(fit.model_1, m.C, m.M)
m.C <- rbind(c(rep(0,17), 1, rep(0,6)), c(rep(0,18), 1, rep(0,5)), c(rep(0,19), 1, rep(0,4)), c(rep(0,20), 1, rep(0,3)), c(rep(0,21), 1, rep(0,2)), c(rep(0,22), 1, 0), c(rep(0,23), 1))
m.M <- cbind(rep(0, 7))
testeF.CBM.MLG(fit.model_1, m.C, m.M)
summary(fit.model_1)
m.C <- rbind(c(rep(0,17), 1, rep(0,6)), c(rep(0,19), 1, rep(0,4)), c(rep(0,20), 1, rep(0,3)), c(rep(0,21), 1, rep(0,2)), c(rep(0,23), 1))
m.M <- cbind(rep(0, 5))
testeF.CBM.MLG(fit.model_1, m.C, m.M)
summary(fit.model_1)
m.C <- rbind(c(rep(0,15), 1, rep(0,8)), c(rep(0,16), 1, rep(0,7)), c(rep(0,19), 1, rep(0,4)), c(rep(0,20), 1, rep(0,3)), c(rep(0,21), 1, rep(0,2)), c(rep(0,23), 1))
m.M <- cbind(rep(0, 6))
testeF.CBM.MLG(fit.model_1, m.C, m.M)
fit.model_2 <- glm(dados$`Nº de infecções` ~ dados$`Hab. de nadar`*dados$Local*dados$`Faixa etária` + dados$`Hab. de nadar`*dados$Local*dados$Sexo + dados$`Hab. de nadar`*dados$`Faixa etária`*dados$Sexo + dados$Local*dados$`Faixa etária`*dados$Sexo,family=poisson(link="log"),data=dados)
summary(fit.model_2)
diagPoisson(fit.model_2)
envelPoisson(fit.model_2, "log")
summary(fit.model_2)
envelPoisson(fit.model_2, "log")
summary(fit.model_2)
m.C <- rbind(c(rep(0,15), 1, rep(0,6)), c(rep(0,16), 1, rep(0,5)), c(rep(0,17), 1, rep(0,4)), c(rep(0,18), 1, rep(0,3)), c(rep(0,19), 1, rep(0,2)), c(rep(0,20), 1, 0), c(rep(0,21), 1))
m.M <- cbind(rep(0, 7))
testeF.CBM.MLG(fit.model_1, m.C, m.M)
m.C <- rbind(c(rep(0,15), 1, rep(0,6)), c(rep(0,16), 1, rep(0,5)), c(rep(0,17), 1, rep(0,4)), c(rep(0,18), 1, rep(0,3)), c(rep(0,19), 1, rep(0,2)), c(rep(0,20), 1, 0), c(rep(0,21), 1))
m.M <- cbind(rep(0, 7))
testeF.CBM.MLG(fit.model_2, m.C, m.M)
m.C <- rbind(c(rep(0,15), 1, rep(0,6)), c(rep(0,16), 1, rep(0,5)), c(rep(0,17), 1, rep(0,4)), c(rep(0,18), 1, rep(0,3)), c(rep(0,19), 1, rep(0,2)), c(rep(0,20), 1, 0))
m.M <- cbind(rep(0, 6))
testeF.CBM.MLG(fit.model_2, m.C, m.M)
summary(fit.model_2)
m.C <- rbind(c(rep(0,16), 1, rep(0,5)), c(rep(0,17), 1, rep(0,4)), c(rep(0,18), 1, rep(0,3)), c(rep(0,19), 1, rep(0,2)), c(rep(0,20), 1, 0), c(rep(0,21), 1))
m.M <- cbind(rep(0, 6))
testeF.CBM.MLG(fit.model_2, m.C, m.M)
summary(fit.model_2)
m.C <- rbind(c(rep(0,16), 1, rep(0,5)), c(rep(0,17), 1, rep(0,4)), c(rep(0,18), 1, rep(0,3)), c(rep(0,19), 1, rep(0,2)), c(rep(0,20), 1, 0), c(rep(0,21), 1))
summary(fit.model_2)
m.C <- rbind(c(rep(0,16), 1, rep(0,5)), c(rep(0,17), 1, rep(0,4)), c(rep(0,18), 1, rep(0,3)), c(rep(0,19), 1, rep(0,2)), c(rep(0,20), 1, 0), c(rep(0,21), 1))
#m.C <- rbind(c(rep(0,7), 1, rep(0,14)), c(rep(0,8), 1, rep(0,13)), c(rep(0,9), 1, rep(0,12)), c(rep(0,10), 1, rep(0,11)), c(rep(0,15), 1, rep(0,6)), c(rep(0,16), 1, rep(0,5)))
m.M <- cbind(rep(0, 6))
testeF.CBM.MLG(fit.model_2, m.C, m.M)
summary(fit.model_2)
m.C <- rbind(c(rep(0,16), 1, rep(0,5)), c(rep(0,17), 1, rep(0,4)), c(rep(0,18), 1, rep(0,3)), c(rep(0,19), 1, rep(0,2)), c(rep(0,20), 1, 0))
m.M <- cbind(rep(0, 5))
testeF.CBM.MLG(fit.model_2, m.C, m.M)
summary(fit.model_2)
